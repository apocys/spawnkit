<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SpawnKit â€” Your AI Team Dashboard</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg-dark: #0a0a0f;
            --bg-card: rgba(20, 20, 20, 0.85);
            --text-primary: #e0e0e0;
            --text-secondary: #aaa;
            --text-muted: #666;
            --border-subtle: rgba(255,255,255,0.1);
            --border-hover: rgba(255,255,255,0.3);
            --accent-cyan: #00ffff;
            --accent-magenta: #ff00ff;
            --sidebar-bg: rgba(10,10,20,0.92);
            --sidebar-width: 300px;
            --btn-min: 48px;
            --transition-smooth: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --theme-accent: #007AFF; /* Default to Executive blue */
        }

        html, body {
            height: 100%;
            overflow: hidden;
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg-dark);
            color: var(--text-primary);
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .starfield {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 0;
        }
        .starfield::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 200%;
            background-image:
                radial-gradient(circle, rgba(255,255,255,0.12) 1px, transparent 1px),
                radial-gradient(circle, rgba(255,255,255,0.06) 1px, transparent 1px),
                radial-gradient(circle, rgba(0,255,255,0.08) 1px, transparent 1px);
            background-size: 80px 80px, 130px 130px, 200px 200px;
            animation: drift 60s linear infinite;
        }
        @keyframes drift {
            from { transform: translateY(0); }
            to   { transform: translateY(-80px); }
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        #themeSelector {
            position: fixed;
            inset: 0;
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 32px;
            padding: 24px;
            overflow-y: auto;
            background: linear-gradient(135deg, #0a0a0f 0%, #1a1a2a 100%);
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }
        #themeSelector.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .selector-header {
            text-align: center;
            z-index: 1;
        }
        .selector-logo {
            font-size: clamp(2rem, 5vw, 3.2rem);
            font-weight: 600;
            background: linear-gradient(45deg, var(--accent-cyan), var(--accent-magenta), #ffff00);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradShift 3s ease-in-out infinite alternate;
            letter-spacing: 6px;
        }
        @keyframes gradShift {
            0%   { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }
        .selector-tagline {
            margin-top: 10px;
            font-size: clamp(0.85rem, 2vw, 1.1rem);
            color: rgba(255,255,255,0.7);
        }
        .selector-subtitle {
            margin-top: 20px;
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        /* Cards grid */
        .cards-grid {
            display: flex;
            gap: 24px;
            flex-wrap: wrap;
            justify-content: center;
            z-index: 1;
            max-width: 960px;
        }

        .theme-card {
            background: var(--bg-card);
            border: 2px solid var(--border-subtle);
            border-radius: 12px;
            width: 280px;
            padding: 24px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            cursor: pointer;
            transition: transform var(--transition-smooth), border-color var(--transition-smooth), box-shadow var(--transition-smooth);
            backdrop-filter: blur(10px);
            position: relative;
            opacity: 0;
            transform: translateY(40px);
        }
        .theme-card.visible {
            opacity: 1;
            transform: translateY(0);
            transition: opacity 0.6s ease, transform 0.6s ease, border-color var(--transition-smooth), box-shadow var(--transition-smooth);
        }
        .theme-card:hover {
            transform: translateY(-8px) scale(1.02);
            border-color: var(--border-hover);
            box-shadow: 0 16px 40px rgba(0,0,0,0.4);
        }
        .theme-card:active {
            transform: translateY(-2px) scale(0.98);
            transition-duration: 0.1s;
        }
        .theme-card:focus-visible {
            outline: 2px solid var(--accent-cyan);
            outline-offset: 4px;
        }

        /* Per-theme glow on hover */
        .theme-card[data-theme="executive"]:hover      { border-color: #007AFF; box-shadow: 0 12px 32px rgba(0,122,255,0.2); }
        .theme-card[data-theme="gameboy"]:hover       { border-color: #9BBB0F; box-shadow: 0 12px 32px rgba(155,187,15,0.2); }
        .theme-card[data-theme="gameboy-color"]:hover  { border-color: #ff6688; box-shadow: 0 12px 32px rgba(255,102,136,0.2); }
        .theme-card[data-theme="sims"]:hover           { border-color: #00ff00; box-shadow: 0 12px 32px rgba(0,255,0,0.15); }

        .card-emoji {
            font-size: 3rem;
            margin-bottom: 12px;
            animation: bobble 3s ease-in-out infinite;
        }
        @keyframes bobble {
            0%, 100% { transform: translateY(0); }
            50%      { transform: translateY(-8px); }
        }

        .card-name {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 6px;
        }
        .card-desc {
            font-size: 0.78rem;
            color: var(--text-secondary);
            line-height: 1.5;
            margin-bottom: 18px;
            min-height: 36px;
        }

        /* Animated preview area */
        .card-preview {
            width: 100%;
            height: 80px;
            border-radius: 8px;
            margin-bottom: 14px;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.06);
        }

        /* Executive preview: clean gradient with grid of circles */
        .theme-card[data-theme="executive"] .card-preview {
            background: linear-gradient(135deg, #1C1C1E, #2C2C2E);
        }
        .theme-card[data-theme="executive"] .card-preview::before {
            content: '';
            position: absolute;
            inset: 0;
            background-image:
                radial-gradient(circle, rgba(0,122,255,0.15) 2px, transparent 2px);
            background-size: 20px 20px;
            animation: executiveGrid 8s linear infinite;
        }
        .theme-card[data-theme="executive"] .card-preview::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #007AFF, #007AFF);
            opacity: 0.8;
        }
        @keyframes executiveGrid {
            from { background-position: 0 0; }
            to { background-position: 20px 20px; }
        }

        /* GameBoy preview: scrolling pixel grid */
        .theme-card[data-theme="gameboy"] .card-preview {
            background: #306230;
        }
        .theme-card[data-theme="gameboy"] .card-preview::before {
            content: '';
            position: absolute;
            inset: 0;
            background-image:
                linear-gradient(0deg, rgba(15,56,15,0.3) 1px, transparent 1px),
                linear-gradient(90deg, rgba(15,56,15,0.3) 1px, transparent 1px);
            background-size: 8px 8px;
            animation: gridScroll 4s linear infinite;
        }
        .theme-card[data-theme="gameboy"] .card-preview::after {
            content: 'â–¶ â–  â–  â–¶';
            position: absolute;
            bottom: 12px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7rem;
            color: #9BBB0F;
            letter-spacing: 6px;
            animation: pixelBlink 1.5s step-end infinite;
        }
        @keyframes gridScroll {
            from { background-position: 0 0; }
            to { background-position: 8px 8px; }
        }
        @keyframes pixelBlink {
            0%, 80% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        /* GameBoy Color preview: rainbow wave */
        .theme-card[data-theme="gameboy-color"] .card-preview {
            background: linear-gradient(135deg, #1a0a2a, #2a1a4a);
        }
        .theme-card[data-theme="gameboy-color"] .card-preview::before {
            content: '';
            position: absolute;
            inset: -50%;
            background: conic-gradient(
                from 0deg,
                #ff6688, #66ccff, #88ff66, #ffcc44, #ff6688
            );
            opacity: 0.15;
            animation: colorSpin 6s linear infinite;
        }
        .theme-card[data-theme="gameboy-color"] .card-preview::after {
            content: 'â— â— â—';
            position: absolute;
            bottom: 12px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            background: linear-gradient(90deg, #ff6688, #66ccff, #88ff66);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 8px;
            animation: colorPulse 2s ease-in-out infinite;
        }
        @keyframes colorSpin {
            to { transform: rotate(360deg); }
        }
        @keyframes colorPulse {
            0%, 100% { opacity: 1; transform: translateX(-50%) scale(1); }
            50% { opacity: 0.6; transform: translateX(-50%) scale(1.1); }
        }

        /* The Sims preview: plumbob float */
        .theme-card[data-theme="sims"] .card-preview {
            background: linear-gradient(180deg, #1a3a4a, #0d2030);
        }
        .theme-card[data-theme="sims"] .card-preview::before {
            content: 'â—†';
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 1.4rem;
            color: #00cc00;
            text-shadow: 0 0 12px rgba(0,204,0,0.6), 0 0 24px rgba(0,204,0,0.3);
            animation: plumbobFloat 2.5s ease-in-out infinite;
        }
        .theme-card[data-theme="sims"] .card-preview::after {
            content: '';
            position: absolute;
            bottom: 12px;
            left: 15%;
            right: 15%;
            height: 4px;
            background: linear-gradient(90deg,
                #00cc00 0%, #00cc00 60%,
                rgba(255,255,255,0.1) 60%, rgba(255,255,255,0.1) 100%
            );
            border-radius: 2px;
        }
        @keyframes plumbobFloat {
            0%, 100% { transform: translateX(-50%) translateY(0) rotate(0deg); }
            25% { transform: translateX(-50%) translateY(-6px) rotate(5deg); }
            75% { transform: translateX(-50%) translateY(-6px) rotate(-5deg); }
        }

        /* Color swatch bar */
        .card-swatch {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            margin-bottom: 18px;
            position: relative;
            overflow: hidden;
        }
        .card-swatch::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s ease-in-out infinite;
        }
        @keyframes shimmer {
            from { transform: translateX(-100%); }
            to   { transform: translateX(100%); }
        }
        .theme-card[data-theme="executive"]    .card-swatch { background: linear-gradient(90deg, #007AFF, #5AC8FA, #34C759); }
        .theme-card[data-theme="gameboy"]      .card-swatch { background: linear-gradient(90deg, #0F380F, #306230, #8BAC0F, #9BBB0F); }
        .theme-card[data-theme="gameboy-color"] .card-swatch { background: linear-gradient(90deg, #ff6688, #66ccff, #88ff66, #ffcc44); }
        .theme-card[data-theme="sims"]          .card-swatch { background: linear-gradient(90deg, #1a3a4a, #5a8898, #00cc00, #d4aa44); }

        .card-btn {
            background: rgba(255,255,255,0.08);
            border: 2px solid rgba(255,255,255,0.15);
            color: var(--text-primary);
            padding: 12px 28px;
            border-radius: 6px;
            font-family: inherit;
            font-weight: 500;
            font-size: 0.85rem;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: background var(--transition-smooth), border-color var(--transition-smooth), color var(--transition-smooth);
            min-height: var(--btn-min);
            min-width: 140px;
        }
        .card-btn:hover { background: rgba(255,255,255,0.18); border-color: rgba(255,255,255,0.35); }

        /* Shortcut badge on card */
        .card-shortcut {
            position: absolute;
            top: 10px;
            right: 12px;
            width: 24px;
            height: 24px;
            border-radius: 6px;
            background: rgba(255,255,255,0.06);
            border: 1px solid rgba(255,255,255,0.12);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.65rem;
            color: var(--text-muted);
            opacity: 0;
            transition: opacity var(--transition-smooth);
        }
        .theme-card:hover .card-shortcut { opacity: 1; }

        /* Recommended badge */
        .card-badge {
            position: absolute;
            top: 12px;
            left: 12px;
            background: #007AFF;
            color: white;
            font-size: 0.6rem;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 12px;
            letter-spacing: 0.5px;
        }
        .theme-card[data-theme="executive"]    .card-btn:hover { background: #007AFF; border-color: #007AFF; color: white; }
        .theme-card[data-theme="gameboy"]      .card-btn:hover { background: #9BBB0F; border-color: #9BBB0F; color: #0F380F; }
        .theme-card[data-theme="gameboy-color"] .card-btn:hover { background: #ff6688; border-color: #ff6688; color: #1a0a2a; }
        .theme-card[data-theme="sims"]          .card-btn:hover { background: #00cc00; border-color: #00cc00; color: #1a3a4a; }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        #loadingOverlay {
            position: fixed;
            inset: 0;
            z-index: 200;
            background: rgba(0,0,0,0.92);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }
        #loadingOverlay.active { display: flex; }

        .spinner {
            width: 48px;
            height: 48px;
            border: 3px solid rgba(255,255,255,0.1);
            border-top-color: var(--accent-cyan);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        .loading-label {
            font-size: 0.9rem;
            color: var(--accent-cyan);
            text-transform: uppercase;
            letter-spacing: 2px;
            animation: labelPulse 2s ease-in-out infinite;
        }
        @keyframes labelPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        #officeFrame {
            position: fixed;
            inset: 0;
            width: 100%;
            height: 100%;
            border: none;
            z-index: 10;
            display: none;
            background: var(--bg-dark);
        }
        #officeFrame.active { display: block; }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        #menuBtn {
            position: fixed;
            top: 12px;
            left: 12px;
            z-index: 500;
            width: var(--btn-min);
            height: var(--btn-min);
            border-radius: 10px;
            border: none;
            background: rgba(20,20,30,0.85);
            backdrop-filter: blur(8px);
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 5px;
            padding: 0;
            transition: background var(--transition-smooth), transform var(--transition-smooth);
            box-shadow: 0 2px 12px rgba(0,0,0,0.4);
        }
        #menuBtn.visible { display: flex; }
        #menuBtn:hover { background: rgba(40,40,60,0.95); transform: scale(1.08); }
        #menuBtn .bar {
            width: 22px;
            height: 2px;
            background: var(--text-primary);
            border-radius: 2px;
            transition: transform var(--transition-smooth), opacity var(--transition-smooth);
        }
        #menuBtn.open .bar:nth-child(1) { transform: rotate(45deg) translate(5px, 5px); }
        #menuBtn.open .bar:nth-child(2) { opacity: 0; }
        #menuBtn.open .bar:nth-child(3) { transform: rotate(-45deg) translate(5px, -5px); }

        /* Tooltip for menu button */
        #menuBtn::after {
            content: attr(aria-label);
            position: absolute;
            left: calc(100% + 8px);
            top: 50%;
            transform: translateY(-50%);
            background: rgba(20,20,30,0.9);
            color: var(--text-secondary);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.7rem;
            font-family: inherit;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease;
        }
        #menuBtn:hover::after { opacity: 1; }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        #sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: var(--sidebar-width);
            height: 100%;
            z-index: 400;
            background: var(--sidebar-bg);
            backdrop-filter: blur(16px);
            border-right: 1px solid rgba(255,255,255,0.08);
            transform: translateX(-100%);
            transition: transform var(--transition-smooth);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        #sidebar.open { transform: translateX(0); }

        /* Backdrop overlay when sidebar open */
        #sidebarBackdrop {
            position: fixed;
            inset: 0;
            z-index: 350;
            background: rgba(0,0,0,0.4);
            opacity: 0;
            visibility: hidden;
            transition: opacity var(--transition-smooth), visibility var(--transition-smooth);
        }
        #sidebarBackdrop.visible { opacity: 1; visibility: visible; }

        .sidebar-header {
            padding: 16px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid rgba(255,255,255,0.06);
            min-height: 60px;
        }
        .sidebar-title {
            font-size: 1rem;
            font-weight: 600;
            letter-spacing: 1px;
        }
        .sidebar-close {
            width: var(--btn-min);
            height: var(--btn-min);
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-size: 1.4rem;
            cursor: pointer;
            border-radius: 8px;
            transition: background var(--transition-smooth), color var(--transition-smooth);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .sidebar-close:hover { background: rgba(255,255,255,0.08); color: var(--text-primary); }

        .sidebar-body {
            flex: 1;
            overflow-y: auto;
            padding: 16px 20px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            scrollbar-width: thin;
            scrollbar-color: rgba(255,255,255,0.1) transparent;
        }
        .sidebar-body::-webkit-scrollbar { width: 6px; }
        .sidebar-body::-webkit-scrollbar-track { background: transparent; }
        .sidebar-body::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 3px; }
        .sidebar-body::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.2); }

        .sidebar-section-label {
            font-size: 0.65rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-top: 8px;
        }

        /* Mission stats */
        .mission-stats {
            display: flex;
            gap: 10px;
            margin-bottom: 4px;
        }
        .stat-card {
            flex: 1;
            background: rgba(255,255,255,0.04);
            border: 1px solid rgba(255,255,255,0.06);
            border-radius: 8px;
            padding: 10px 12px;
            text-align: center;
        }
        .stat-value {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--accent-cyan);
        }
        .stat-label {
            font-size: 0.62rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 2px;
        }

        /* Agent list items */
        .agent-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: background var(--transition-smooth);
            min-height: var(--btn-min);
        }
        .agent-item:hover { background: rgba(255,255,255,0.06); }

        .agent-sprite {
            width: 36px;
            height: 36px;
            border-radius: 6px;
            background: rgba(255,255,255,0.08);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .agent-info {
            flex: 1;
            min-width: 0;
        }
        .agent-name {
            font-size: 0.82rem;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .agent-role {
            font-size: 0.68rem;
            color: var(--text-muted);
        }

        .agent-level-bar {
            width: 100%;
            height: 4px;
            background: rgba(255,255,255,0.08);
            border-radius: 2px;
            margin-top: 4px;
            overflow: hidden;
        }
        .agent-level-fill {
            height: 100%;
            border-radius: 2px;
            transition: width 0.6s ease;
        }

        /* Agent detail expand */
        .agent-detail {
            max-height: 0;
            overflow: hidden;
            transition: max-height var(--transition-smooth), padding var(--transition-smooth);
            padding: 0 12px;
            font-size: 0.72rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }
        .agent-detail.expanded {
            max-height: 200px;
            padding: 8px 12px 12px;
        }

        /* Create agent button */
        .create-agent-btn {
            min-height: var(--btn-min);
            border: 2px dashed rgba(100,255,100,0.3);
            background: transparent;
            color: #66ff66;
            border-radius: 8px;
            font-family: inherit;
            font-size: 0.82rem;
            cursor: pointer;
            transition: background var(--transition-smooth), border-color var(--transition-smooth);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .create-agent-btn:hover { background: rgba(100,255,100,0.08); border-color: rgba(100,255,100,0.5); }

        /* Switch theme button */
        .switch-theme-btn {
            min-height: var(--btn-min);
            border: 1px solid rgba(255,255,255,0.1);
            background: rgba(255,255,255,0.04);
            color: var(--text-secondary);
            border-radius: 8px;
            font-family: inherit;
            font-size: 0.75rem;
            cursor: pointer;
            transition: background var(--transition-smooth), color var(--transition-smooth);
            margin-top: auto;
            padding: 12px;
        }
        .switch-theme-btn:hover { background: rgba(255,255,255,0.08); color: var(--text-primary); }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        #welcomeTooltip {
            position: fixed;
            inset: 0;
            z-index: 150;
            display: none;
            align-items: center;
            justify-content: center;
            background: rgba(0,0,0,0.6);
        }
        #welcomeTooltip.active { display: flex; }
        .tooltip-box {
            background: rgba(20,20,30,0.95);
            border: 1px solid var(--accent-cyan);
            border-radius: 12px;
            padding: 28px 36px;
            text-align: center;
            max-width: 380px;
            animation: tooltipIn 0.4s ease;
        }
        @keyframes tooltipIn {
            from { opacity: 0; transform: scale(0.9) translateY(16px); }
            to   { opacity: 1; transform: scale(1) translateY(0); }
        }
        .tooltip-text {
            font-size: 0.9rem;
            line-height: 1.6;
            margin-bottom: 20px;
            color: var(--text-primary);
        }
        .tooltip-dismiss {
            min-height: var(--btn-min);
            min-width: 120px;
            background: var(--accent-cyan);
            color: #000;
            border: none;
            border-radius: 8px;
            font-family: inherit;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: background var(--transition-smooth);
        }
        .tooltip-dismiss:hover { background: #33ffff; }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           EXECUTIVE THEME â€” Light Mode Overrides
           Scoped to .theme-executive so dark themes
           (GameBoy, GBC, Sims) are NOT affected.
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        body.theme-executive {
            background: #F5F5F7;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        body.theme-executive .starfield { display: none; }

        body.theme-executive #menuBtn {
            background: rgba(255,255,255,0.85);
            border: 1px solid rgba(0,0,0,0.08);
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
        }
        body.theme-executive #menuBtn:hover {
            background: rgba(255,255,255,0.95);
        }
        body.theme-executive #menuBtn .bar {
            background: #1C1C1E;
        }
        body.theme-executive #menuBtn::after {
            background: rgba(255,255,255,0.95);
            color: #636366;
        }

        body.theme-executive #sidebar {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border-right: 1px solid rgba(0,0,0,0.06);
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        body.theme-executive .sidebar-header {
            border-bottom-color: rgba(0,0,0,0.06);
        }
        body.theme-executive .sidebar-title {
            color: #1C1C1E;
        }
        body.theme-executive .sidebar-close {
            color: #8E8E93;
        }
        body.theme-executive .sidebar-close:hover {
            background: rgba(0,0,0,0.04);
            color: #1C1C1E;
        }

        body.theme-executive .sidebar-section-label {
            color: #8E8E93;
        }

        body.theme-executive .stat-card {
            background: rgba(0,0,0,0.03);
            border-color: rgba(0,0,0,0.06);
        }
        body.theme-executive .stat-value {
            color: #007AFF;
        }
        body.theme-executive .stat-label {
            color: #8E8E93;
        }

        body.theme-executive .agent-item:hover {
            background: rgba(0,0,0,0.04);
        }
        body.theme-executive .agent-name {
            color: #1C1C1E;
        }
        body.theme-executive .agent-role {
            color: #8E8E93;
        }
        body.theme-executive .agent-level-bar {
            background: rgba(0,0,0,0.06);
        }
        body.theme-executive .agent-sprite {
            background: rgba(0,0,0,0.04);
        }
        body.theme-executive .agent-detail {
            color: #636366;
        }

        body.theme-executive .create-agent-btn {
            border-color: rgba(0,122,255,0.3);
            color: #007AFF;
        }
        body.theme-executive .create-agent-btn:hover {
            background: rgba(0,122,255,0.06);
            border-color: rgba(0,122,255,0.5);
        }

        body.theme-executive .switch-theme-btn {
            border-color: rgba(0,0,0,0.08);
            background: rgba(0,0,0,0.03);
            color: #636366;
        }
        body.theme-executive .switch-theme-btn:hover {
            background: rgba(0,0,0,0.06);
            color: #1C1C1E;
        }

        body.theme-executive #sidebarBackdrop {
            background: rgba(0,0,0,0.2);
        }

        body.theme-executive .sidebar-body::-webkit-scrollbar-thumb {
            background: rgba(0,0,0,0.1);
        }
        body.theme-executive .sidebar-body::-webkit-scrollbar-thumb:hover {
            background: rgba(0,0,0,0.2);
        }

        /* Executive loading overlay â€” light with blue spinner */
        body.theme-executive #loadingOverlay {
            background: rgba(255,255,255,0.95);
        }
        body.theme-executive .spinner {
            border-color: rgba(0,0,0,0.08);
            border-top-color: #007AFF;
        }
        body.theme-executive .loading-label {
            color: #007AFF;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        @media (max-width: 767px) {
            .cards-grid {
                flex-direction: column;
                align-items: center;
            }
            .theme-card { width: min(300px, 90vw); }

            #sidebar {
                top: auto;
                bottom: 0;
                left: 0;
                width: 100%;
                height: auto;
                max-height: 60vh;
                border-right: none;
                border-top: 1px solid rgba(255,255,255,0.08);
                border-radius: 16px 16px 0 0;
                transform: translateY(100%);
            }
            #sidebar.open { transform: translateY(0); }

            .drag-handle {
                display: block !important;
            }
        }

        /* Desktop: hide drag handle */
        .drag-handle {
            display: none;
            width: 40px;
            height: 5px;
            background: rgba(255,255,255,0.2);
            border-radius: 3px;
            margin: 10px auto 0;
            flex-shrink: 0;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           HELP OVERLAY
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        #helpOverlay {
            position: fixed;
            inset: 0;
            z-index: 600;
            display: none;
            align-items: center;
            justify-content: center;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(6px);
        }
        #helpOverlay.active { display: flex; }
        .help-box {
            background: rgba(15,15,25,0.97);
            border: 1px solid var(--accent-cyan);
            border-radius: 16px;
            padding: 32px 40px;
            max-width: 420px;
            width: 90vw;
            animation: tooltipIn 0.35s ease;
        }
        .help-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--accent-cyan);
            text-align: center;
        }
        .help-row {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .help-row:last-child { border-bottom: none; }
        .help-key {
            min-width: 48px;
            text-align: center;
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 6px;
            padding: 6px 10px;
            font-size: 0.78rem;
            font-weight: 500;
            color: var(--accent-cyan);
            flex-shrink: 0;
        }
        .help-desc {
            font-size: 0.82rem;
            color: var(--text-secondary);
        }
        .help-close {
            display: block;
            margin: 24px auto 0;
            min-height: var(--btn-min);
            min-width: 120px;
            background: var(--accent-cyan);
            color: #000;
            border: none;
            border-radius: 8px;
            font-family: inherit;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: background var(--transition-smooth);
        }
        .help-close:hover { background: #33ffff; }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           FOOTER
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .selector-footer {
            z-index: 1;
            margin-top: 32px;
            text-align: center;
            font-size: 0.7rem;
            color: var(--text-muted);
            letter-spacing: 1px;
            opacity: 0;
            animation: fadeInUp 0.8s ease 0.8s forwards;
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .selector-footer .footer-hint {
            margin-top: 6px;
            color: rgba(255,255,255,0.25);
            font-size: 0.65rem;
        }
    </style>
</head>
<body>

<!-- Starfield background -->
<div class="starfield"></div>

<!-- â•â•â• FIRST-VISIT TOOLTIP â•â•â• -->
<div id="welcomeTooltip">
    <div class="tooltip-box">
        <div class="tooltip-text">
            ğŸ‘‹ Welcome to SpawnKit!<br><br>
            Pick your favorite office style below.<br>
            Your AI team is waiting inside.
        </div>
        <button class="tooltip-dismiss" id="dismissTooltip">Got it!</button>
    </div>
</div>

<!-- â•â•â• THEME SELECTOR â•â•â• -->
<div id="themeSelector">
    <div class="starfield"></div>

    <div class="selector-header">
        <div class="selector-logo">SPAWNKIT</div>
        <div class="selector-tagline">Your AI team, visualized.</div>
        <div class="selector-subtitle">Choose your office style</div>
    </div>

    <div class="cards-grid" id="cardsGrid">
        <!-- Executive -->
        <div class="theme-card" data-theme="executive" tabindex="0" role="button" aria-label="Enter Executive Office">
            <span class="card-shortcut">1</span>
            <span class="card-badge">â˜… Recommended</span>
            <div class="card-emoji">ğŸ¢</div>
            <div class="card-name">Executive</div>
            <div class="card-desc">Professional AI workspace. Clean, fast, beautiful.</div>
            <div class="card-preview"></div>
            <div class="card-swatch"></div>
            <button class="card-btn">Enter Office</button>
        </div>

        <!-- GameBoy -->
        <div class="theme-card" data-theme="gameboy" tabindex="0" role="button" aria-label="Enter GameBoy Office">
            <span class="card-shortcut">2</span>
            <div class="card-emoji">ğŸ®</div>
            <div class="card-name">GameBoy</div>
            <div class="card-desc">Pixel quests and 8-bit charm. Your agents explore a retro green world.</div>
            <div class="card-preview"></div>
            <div class="card-swatch"></div>
            <button class="card-btn">Enter Office</button>
        </div>

        <!-- GameBoy Color -->
        <div class="theme-card" data-theme="gameboy-color" tabindex="0" role="button" aria-label="Enter GameBoy Color Office">
            <span class="card-shortcut">3</span>
            <div class="card-emoji">ğŸŒˆ</div>
            <div class="card-name">GameBoy Color</div>
            <div class="card-desc">Same retro soul, now in vivid color. Upgraded pixels, same heart.</div>
            <div class="card-preview"></div>
            <div class="card-swatch"></div>
            <button class="card-btn">Enter Office</button>
        </div>

        <!-- The Sims -->
        <div class="theme-card" data-theme="sims" tabindex="0" role="button" aria-label="Enter The Sims Office">
            <span class="card-shortcut">4</span>
            <div class="card-emoji">ğŸ’</div>
            <div class="card-name">The Sims</div>
            <div class="card-desc">Isometric nostalgia with need bars and plumbobs. It's 2000 again.</div>
            <div class="card-preview"></div>
            <div class="card-swatch"></div>
            <button class="card-btn">Enter Office</button>
        </div>
    </div>

    <div class="selector-footer">
        Powered by SpawnKit â€¢ Built with OpenClaw
        <div class="footer-hint">Press <strong>?</strong> for keyboard shortcuts</div>
    </div>
</div>

<!-- â•â•â• HELP OVERLAY â•â•â• -->
<div id="helpOverlay">
    <div class="help-box">
        <div class="help-title">âŒ¨ï¸ Keyboard Shortcuts</div>
        <div class="help-row"><span class="help-key">?</span><span class="help-desc">Show this help</span></div>
        <div class="help-row"><span class="help-key">1</span><span class="help-desc">Enter Executive office</span></div>
        <div class="help-row"><span class="help-key">2</span><span class="help-desc">Enter GameBoy office</span></div>
        <div class="help-row"><span class="help-key">3</span><span class="help-desc">Enter GameBoy Color office</span></div>
        <div class="help-row"><span class="help-key">4</span><span class="help-desc">Enter The Sims office</span></div>
        <div class="help-row"><span class="help-key">Tab</span><span class="help-desc">Toggle team sidebar</span></div>
        <div class="help-row"><span class="help-key">Esc</span><span class="help-desc">Close sidebar or overlay</span></div>
        <button class="help-close" id="helpClose">Got it!</button>
    </div>
</div>

<!-- â•â•â• LOADING OVERLAY â•â•â• -->
<div id="loadingOverlay">
    <div class="spinner"></div>
    <div class="loading-label" id="loadingLabel">Loading office...</div>
</div>

<!-- â•â•â• OFFICE IFRAME â•â•â• -->
<iframe id="officeFrame" title="SpawnKit Office"></iframe>

<!-- â•â•â• HAMBURGER MENU BUTTON â•â•â• -->
<button id="menuBtn" aria-label="Open menu">
    <span class="bar"></span>
    <span class="bar"></span>
    <span class="bar"></span>
</button>

<!-- â•â•â• SIDEBAR BACKDROP â•â•â• -->
<div id="sidebarBackdrop"></div>

<!-- â•â•â• SIDEBAR â•â•â• -->
<div id="sidebar">
    <div class="drag-handle"></div>
    <div class="sidebar-header">
        <div class="sidebar-title">ğŸ§  Your Team</div>
        <button class="sidebar-close" aria-label="Close menu">&times;</button>
    </div>
    <div class="sidebar-body" id="sidebarBody">
        <div class="sidebar-section-label">Overview</div>
        <div id="missionStats" class="mission-stats">
            <!-- Populated by JS -->
        </div>
        <div class="sidebar-section-label">Agents</div>
        <div id="agentList">
            <!-- Populated by JS -->
        </div>
        <button class="create-agent-btn" id="createAgentBtn">
            <span style="font-size:1.2rem;">+</span> Create Agent
        </button>
        <button class="switch-theme-btn" id="switchThemeBtn">ğŸ¨ Switch Office Style</button>
    </div>
</div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SpawnKit Dashboard â€” Main Controller
   Zero innerHTML with user data. textContent only.
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
(function() {
    'use strict';

    // â”€â”€â”€ Config â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    var THEMES = {
        'executive':     { name: 'Executive', path: './office-executive/index.html', emoji: 'ğŸ¢', loadMsg: 'Preparing your workspace\u2026' },
        'gameboy':       { name: 'GameBoy',       path: './office-gameboy/index.html',       emoji: 'ğŸ®', loadMsg: 'Booting up pixels\u2026' },
        'gameboy-color': { name: 'GameBoy Color', path: './office-gameboy-color/index.html', emoji: 'ğŸŒˆ', loadMsg: 'Painting the rainbow\u2026' },
        'sims':          { name: 'The Sims',      path: './office-sims/index.html',          emoji: 'ğŸ’', loadMsg: 'Building your world\u2026' }
    };

    var STORAGE = {
        theme:   'spawnkit-dashboard-theme',
        sidebar: 'spawnkit-dashboard-sidebar',
        visited: 'spawnkit-dashboard-visited'
    };

    // Fleet agents â€” synchronized with executive office roster
    var AGENTS = [
        { id: 'apomac',   name: 'ApoMac',   role: 'CEO',           emoji: 'ğŸ', level: 1.0,  color: '#007AFF' },
        { id: 'atlas',    name: 'Atlas',     role: 'COO',           emoji: 'ğŸ—ºï¸', level: 0.8,  color: '#BF5AF2' },
        { id: 'forge',    name: 'Forge',     role: 'CTO',           emoji: 'ğŸ”¨', level: 0.9,  color: '#FF9F0A' },
        { id: 'hunter',   name: 'Hunter',    role: 'Growth',        emoji: 'ğŸ¯', level: 0.65, color: '#FF453A' },
        { id: 'echo',     name: 'Echo',      role: 'CMO',           emoji: 'ğŸ“¢', level: 0.5,  color: '#0A84FF' },
        { id: 'sentinel', name: 'Sentinel',  role: 'QA & Security', emoji: 'ğŸ›¡ï¸', level: 0.9,  color: '#30D158' }
    ];

    // â”€â”€â”€ DOM refs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    var $selector      = document.getElementById('themeSelector');
    var $cardsGrid     = document.getElementById('cardsGrid');
    var $loading       = document.getElementById('loadingOverlay');
    var $loadingLabel  = document.getElementById('loadingLabel');
    var $frame         = document.getElementById('officeFrame');
    var $menuBtn       = document.getElementById('menuBtn');
    var $sidebar       = document.getElementById('sidebar');
    var $backdrop      = document.getElementById('sidebarBackdrop');
    var $agentList     = document.getElementById('agentList');
    var $createBtn     = document.getElementById('createAgentBtn');
    var $switchBtn     = document.getElementById('switchThemeBtn');
    var $sidebarClose  = document.querySelector('.sidebar-close');
    var $welcomeTooltip = document.getElementById('welcomeTooltip');
    var $dismissTooltip = document.getElementById('dismissTooltip');

    // â”€â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    var currentTheme = null;
    var sidebarOpen  = false;
    var expandedAgent = null;

    // â”€â”€â”€ Helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function safeGet(key) {
        try { return localStorage.getItem(key); } catch(e) { return null; }
    }
    function safeSet(key, val) {
        try { localStorage.setItem(key, val); } catch(e) { /* quota or private */ }
    }

    // â”€â”€â”€ Welcome tooltip â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function maybeShowWelcome() {
        if (safeGet(STORAGE.visited)) return;
        $welcomeTooltip.classList.add('active');
    }

    $dismissTooltip.addEventListener('click', function() {
        $welcomeTooltip.classList.remove('active');
        safeSet(STORAGE.visited, 'true');
    });

    // â”€â”€â”€ Card entrance animation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function animateCards() {
        var cards = $cardsGrid.querySelectorAll('.theme-card');
        cards.forEach(function(card, i) {
            setTimeout(function() { card.classList.add('visible'); }, 150 * i);
        });
    }

    // â”€â”€â”€ Theme selection â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function selectTheme(themeId) {
        if (!THEMES[themeId]) return;
        currentTheme = themeId;
        safeSet(STORAGE.theme, themeId);

        // Toggle executive light-mode class on body
        if (themeId === 'executive') {
            document.body.classList.add('theme-executive');
        } else {
            document.body.classList.remove('theme-executive');
        }

        // Set theme accent color CSS variable
        var accentColors = {
            'executive': '#007AFF',
            'gameboy': '#9BBB0F',
            'gameboy-color': '#ff6688',
            'sims': '#00cc00'
        };
        document.documentElement.style.setProperty('--theme-accent', accentColors[themeId] || '#007AFF');

        var t = THEMES[themeId];
        $loadingLabel.textContent = t.loadMsg || ('Loading ' + t.name + ' Office\u2026');
        $loading.classList.add('active');

        setTimeout(function() {
            loadOffice(themeId);
        }, 600);
    }

    function loadOffice(themeId) {
        var t = THEMES[themeId];
        if (!t) return;

        $frame.src = t.path;
        $frame.classList.add('active');
        $selector.classList.add('hidden');

        $frame.addEventListener('load', function onLoad() {
            $frame.removeEventListener('load', onLoad);
            $loading.classList.remove('active');
            $menuBtn.classList.add('visible');
        });

        // Fallback: hide loading after 8s even if load event doesn't fire
        setTimeout(function() {
            $loading.classList.remove('active');
            $menuBtn.classList.add('visible');
        }, 8000);
    }

    // â”€â”€â”€ Card click handlers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    $cardsGrid.addEventListener('click', function(e) {
        var card = e.target.closest('.theme-card');
        if (!card) return;
        selectTheme(card.getAttribute('data-theme'));
    });
    $cardsGrid.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' || e.key === ' ') {
            var card = e.target.closest('.theme-card');
            if (!card) return;
            e.preventDefault();
            selectTheme(card.getAttribute('data-theme'));
        }
    });

    // â”€â”€â”€ Sidebar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function openSidebar() {
        sidebarOpen = true;
        $sidebar.classList.add('open');
        $backdrop.classList.add('visible');
        $menuBtn.classList.add('open');
        safeSet(STORAGE.sidebar, 'open');
    }

    function closeSidebar() {
        sidebarOpen = false;
        $sidebar.classList.remove('open');
        $backdrop.classList.remove('visible');
        $menuBtn.classList.remove('open');
        safeSet(STORAGE.sidebar, 'closed');
    }

    function toggleSidebar() {
        if (sidebarOpen) closeSidebar(); else openSidebar();
    }

    $menuBtn.addEventListener('click', toggleSidebar);
    $backdrop.addEventListener('click', closeSidebar);
    $sidebarClose.addEventListener('click', closeSidebar);

    // Close sidebar on Escape
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && sidebarOpen) closeSidebar();
    });

    // â”€â”€â”€ Populate agent list â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function renderAgents() {
        // Clear list
        while ($agentList.firstChild) $agentList.removeChild($agentList.firstChild);

        AGENTS.forEach(function(agent) {
            // Item container
            var item = document.createElement('div');
            item.className = 'agent-item';
            item.setAttribute('tabindex', '0');
            item.setAttribute('role', 'button');
            item.setAttribute('aria-label', agent.name + ', ' + agent.role);

            // Sprite
            var sprite = document.createElement('div');
            sprite.className = 'agent-sprite';
            sprite.textContent = agent.emoji;
            item.appendChild(sprite);

            // Info
            var info = document.createElement('div');
            info.className = 'agent-info';

            var nameEl = document.createElement('div');
            nameEl.className = 'agent-name';
            nameEl.textContent = agent.name;
            info.appendChild(nameEl);

            var roleEl = document.createElement('div');
            roleEl.className = 'agent-role';
            roleEl.textContent = agent.role;
            info.appendChild(roleEl);

            var barOuter = document.createElement('div');
            barOuter.className = 'agent-level-bar';
            var barFill = document.createElement('div');
            barFill.className = 'agent-level-fill';
            barFill.style.width = Math.round(agent.level * 100) + '%';
            barFill.style.background = agent.color;
            barOuter.appendChild(barFill);
            info.appendChild(barOuter);

            item.appendChild(info);

            // Detail section (expandable)
            var detail = document.createElement('div');
            detail.className = 'agent-detail';
            detail.id = 'detail-' + agent.id;
            detail.textContent = agent.name + ' is your ' + (agent.role || '').toLowerCase()
                + '. Level progress: ' + Math.round(agent.level * 100) + '%.';

            $agentList.appendChild(item);
            $agentList.appendChild(detail);

            // Toggle expand
            function toggleDetail() {
                var isExpanded = detail.classList.contains('expanded');
                // Collapse any other
                if (expandedAgent && expandedAgent !== detail) {
                    expandedAgent.classList.remove('expanded');
                }
                if (isExpanded) {
                    detail.classList.remove('expanded');
                    expandedAgent = null;
                } else {
                    detail.classList.add('expanded');
                    expandedAgent = detail;
                }
            }

            item.addEventListener('click', toggleDetail);
            item.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggleDetail(); }
            });
        });
    }

    // â”€â”€â”€ Mission stats â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function renderMissionStats() {
        var $stats = document.getElementById('missionStats');
        while ($stats.firstChild) $stats.removeChild($stats.firstChild);

        var stats = [
            { value: AGENTS.length, label: 'Agents' },
            { value: '3', label: 'Missions' },
            { value: 'âœ“', label: 'Online' }
        ];

        stats.forEach(function(s) {
            var card = document.createElement('div');
            card.className = 'stat-card';

            var val = document.createElement('div');
            val.className = 'stat-value';
            val.textContent = s.value;
            card.appendChild(val);

            var lbl = document.createElement('div');
            lbl.className = 'stat-label';
            lbl.textContent = s.label;
            card.appendChild(lbl);

            $stats.appendChild(card);
        });
    }

    // â”€â”€â”€ Create agent (placeholder) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    $createBtn.addEventListener('click', function() {
        // Show a brief feedback
        $createBtn.textContent = 'âœ… Coming soon!';
        setTimeout(function() {
            $createBtn.textContent = '';
            var span = document.createElement('span');
            span.style.fontSize = '1.2rem';
            span.textContent = '+';
            $createBtn.appendChild(span);
            $createBtn.appendChild(document.createTextNode(' Create Agent'));
        }, 1500);
    });

    // â”€â”€â”€ Switch theme â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    $switchBtn.addEventListener('click', function() {
        closeSidebar();
        $frame.classList.remove('active');
        $frame.src = 'about:blank';
        $selector.classList.remove('hidden');
        $menuBtn.classList.remove('visible');
        document.body.classList.remove('theme-executive');
        currentTheme = null;
        // Don't clear localStorage â€” let them pick a new one
    });

    // â”€â”€â”€ Help overlay â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    var $helpOverlay = document.getElementById('helpOverlay');
    var $helpClose   = document.getElementById('helpClose');

    function openHelp() { $helpOverlay.classList.add('active'); }
    function closeHelp() { $helpOverlay.classList.remove('active'); }

    $helpClose.addEventListener('click', closeHelp);
    $helpOverlay.addEventListener('click', function(e) {
        if (e.target === $helpOverlay) closeHelp();
    });

    // â”€â”€â”€ Keyboard shortcuts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    var THEME_KEYS = { '1': 'executive', '2': 'gameboy', '3': 'gameboy-color', '4': 'sims' };

    document.addEventListener('keydown', function(e) {
        // Don't intercept when typing in an input
        if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;

        // ? â†’ help overlay
        if (e.key === '?' || (e.key === '/' && e.shiftKey)) {
            e.preventDefault();
            if ($helpOverlay.classList.contains('active')) closeHelp();
            else openHelp();
            return;
        }

        // Escape â†’ close help or sidebar
        if (e.key === 'Escape') {
            if ($helpOverlay.classList.contains('active')) { closeHelp(); return; }
            if (sidebarOpen) { closeSidebar(); return; }
            return;
        }

        // Tab â†’ toggle sidebar (only when office is loaded)
        if (e.key === 'Tab' && currentTheme && $frame.classList.contains('active')) {
            e.preventDefault();
            toggleSidebar();
            return;
        }

        // 1/2/3/4 â†’ theme selection (only on selector screen)
        if (THEME_KEYS[e.key] && !$selector.classList.contains('hidden')) {
            e.preventDefault();
            selectTheme(THEME_KEYS[e.key]);
            return;
        }
    });

    // â”€â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function init() {
        renderAgents();
        renderMissionStats();

        // Check for saved theme
        var saved = safeGet(STORAGE.theme);
        if (saved && THEMES[saved]) {
            selectTheme(saved);
        } else {
            // First visit flow - load Executive directly
            selectTheme('executive');
        }
    }

    // Kick off
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }

})();
</script>
</body>
</html>
