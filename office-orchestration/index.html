<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEO Orchestration Dashboard</title>
    <script>window.OC_RELAY_URL = window.OC_RELAY_URL || 'http://127.0.0.1:18790';</script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           CEO Orchestration Dashboard â€” Dark Executive Theme
           Real-time agent task tracking and orchestration
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

        :root {
            /* â”€â”€ Light Executive Palette â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
            --bg-primary: #F8FAFC;
            --bg-secondary: #FFFFFF;
            --bg-tertiary: #F1F5F9;
            --bg-card: #FFFFFF;
            --bg-card-hover: #F8FAFC;
            --bg-accent: rgba(59, 130, 246, 0.05);
            
            --text-primary: #0F172A;
            --text-secondary: #334155;
            --text-tertiary: #64748B;
            --text-muted: #94A3B8;
            
            --border-subtle: rgba(15, 23, 42, 0.06);
            --border-medium: rgba(15, 23, 42, 0.1);
            --border-strong: rgba(15, 23, 42, 0.15);
            
            /* â”€â”€ Status Colors â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
            --status-queued: #64748B;
            --status-progress: #3B82F6;
            --status-done: #10B981;
            --status-failed: #EF4444;
            
            /* â”€â”€ Agent Brand Colors â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
            --color-apomac: #007AFF;
            --color-forge: #FF9F0A;
            --color-hunter: #FF453A;
            --color-echo: #0A84FF;
            --color-sentinel: #30D158;
            --color-atlas: #BF5AF2;
            
            /* â”€â”€ Animation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
            --ease-smooth: cubic-bezier(0.2, 0.8, 0.2, 1);
            --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
            
            /* â”€â”€ Layout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            
            --font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           Reset & Base
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: var(--font-family);
            background: var(--bg-primary);
            color: var(--text-primary);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           Dashboard Container
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .dashboard {
            display: grid;
            grid-template-rows: auto 1fr auto;
            height: 100vh;
            padding: 24px;
            gap: 24px;
            background: var(--bg-primary);
            position: relative;
        }

        .dashboard::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 20%, rgba(59, 130, 246, 0.02) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(168, 85, 247, 0.01) 0%, transparent 50%);
            pointer-events: none;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           Stats Bar
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .stats-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-lg);
            padding: 20px 32px;
            backdrop-filter: blur(12px);
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        }

        .stats-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .stats-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--text-primary);
            line-height: 1;
        }

        .stats-label {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stats-value.highlight {
            background: linear-gradient(135deg, var(--color-apomac), var(--color-echo));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           Main Grid Layout
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .main-grid {
            display: grid;
            grid-template-columns: 2fr 1.2fr;
            gap: 24px;
            height: 100%;
        }

        .left-panel {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .right-panel {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           Kanban Workstreams
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .workstreams {
            flex: 1;
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-lg);
            padding: 24px;
            overflow: hidden;
        }

        .workstreams-header {
            margin-bottom: 20px;
        }

        .workstreams-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .workstreams-subtitle {
            font-size: 14px;
            color: var(--text-tertiary);
        }

        .kanban {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            height: calc(100% - 60px);
        }

        .kanban-column {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .column-header {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            border: 1px solid var(--border-medium);
        }

        .column-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .column-count {
            background: var(--bg-primary);
            color: var(--text-tertiary);
            font-size: 11px;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 4px;
            margin-left: auto;
        }

        .column-tasks {
            flex: 1;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--border-medium) transparent;
        }

        .column-tasks::-webkit-scrollbar {
            width: 4px;
        }

        .column-tasks::-webkit-scrollbar-track {
            background: transparent;
        }

        .column-tasks::-webkit-scrollbar-thumb {
            background: var(--border-medium);
            border-radius: 2px;
        }

        .task-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            padding: 16px;
            cursor: pointer;
            transition: all 0.3s var(--ease-smooth);
            position: relative;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        }

        .task-card:hover {
            background: var(--bg-card-hover);
            border-color: var(--border-medium);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
        }

        .task-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .agent-avatar {
            font-size: 16px;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .agent-name {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .task-time {
            font-size: 11px;
            color: var(--text-muted);
            margin-left: auto;
        }

        .task-description {
            font-size: 13px;
            color: var(--text-primary);
            line-height: 1.4;
            margin-bottom: 8px;
        }

        .task-status {
            display: inline-block;
            font-size: 10px;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .status-queued { background: rgba(100, 116, 139, 0.2); color: var(--status-queued); }
        .status-progress { background: rgba(59, 130, 246, 0.2); color: var(--status-progress); }
        .status-done { background: rgba(16, 185, 129, 0.2); color: var(--status-done); }
        .status-failed { background: rgba(239, 68, 68, 0.2); color: var(--status-failed); }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           Agent Status Grid
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .agent-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 16px;
            height: 400px;
        }

        .agent-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-lg);
            padding: 20px;
            display: flex;
            flex-direction: column;
            transition: all 0.3s var(--ease-smooth);
            position: relative;
            overflow: hidden;
            cursor: pointer;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        }

        .agent-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--agent-color);
            opacity: 0.8;
        }

        .agent-card:hover {
            background: var(--bg-card-hover);
            border-color: var(--border-medium);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .agent-card.apomac { --agent-color: var(--color-apomac); }
        .agent-card.forge { --agent-color: var(--color-forge); }
        .agent-card.hunter { --agent-color: var(--color-hunter); }
        .agent-card.echo { --agent-color: var(--color-echo); }
        .agent-card.sentinel { --agent-color: var(--color-sentinel); }
        .agent-card.atlas { --agent-color: var(--color-atlas); }

        .agent-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        .agent-avatar-large {
            font-size: 24px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(15, 23, 42, 0.05);
            border-radius: var(--radius-md);
        }

        .agent-info h3 {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .agent-role {
            font-size: 12px;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .agent-current-task {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.4;
            margin-bottom: 16px;
            flex: 1;
        }

        .agent-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 16px;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
        }

        .stat-value {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .stat-label {
            font-size: 10px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           Pipeline Flow
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .pipeline {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-lg);
            padding: 24px;
            height: 180px;
        }

        .pipeline-header {
            margin-bottom: 24px;
        }

        .pipeline-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .pipeline-subtitle {
            font-size: 14px;
            color: var(--text-tertiary);
        }

        .pipeline-flow {
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 80px;
        }

        .pipeline-stage {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        .stage-name {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stage-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--border-medium);
            position: relative;
            transition: all 0.3s var(--ease-smooth);
        }

        .stage-dot.active {
            background: var(--color-apomac);
            box-shadow: 0 0 16px rgba(0, 122, 255, 0.4);
        }

        .stage-dot.completed {
            background: var(--status-done);
        }

        .pipeline-connector {
            height: 2px;
            background: var(--border-medium);
            flex: 1;
            margin: 0 16px;
            position: relative;
        }

        .pipeline-connector.active::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: var(--color-apomac);
            animation: flowProgress 2s ease-in-out infinite;
        }

        @keyframes flowProgress {
            0% { width: 0%; }
            50% { width: 100%; }
            100% { width: 100%; }
        }

        .task-indicator {
            position: absolute;
            top: -6px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: var(--color-apomac);
            box-shadow: 0 0 8px rgba(0, 122, 255, 0.6);
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           Animations & Effects
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .pulse {
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .fade-in {
            animation: fadeIn 0.6s var(--ease-smooth);
        }

        @keyframes taskMoved {
            0% { transform: scale(0.92); opacity: 0.3; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.4); }
            40% { transform: scale(1.03); opacity: 1; box-shadow: 0 0 12px 3px rgba(59, 130, 246, 0.25); }
            100% { transform: scale(1); opacity: 1; box-shadow: none; }
        }

        .task-card.just-moved {
            animation: taskMoved 0.8s var(--ease-spring) forwards;
        }

        @keyframes taskLeaving {
            0% { transform: scale(1); opacity: 1; max-height: 120px; margin-bottom: 12px; }
            50% { transform: scale(0.9) translateX(30px); opacity: 0.3; }
            100% { transform: scale(0.8) translateX(60px); opacity: 0; max-height: 0; margin-bottom: 0; padding: 0; overflow: hidden; }
        }

        .task-card.leaving {
            animation: taskLeaving 0.5s var(--ease-smooth) forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           Modal Styles
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(15, 23, 42, 0.5);
            backdrop-filter: blur(8px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s var(--ease-smooth);
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-lg);
            padding: 32px;
            max-width: 500px;
            width: 90vw;
            max-height: 80vh;
            overflow-y: auto;
            transform: translateY(20px) scale(0.95);
            transition: all 0.3s var(--ease-smooth);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .modal-overlay.active .modal {
            transform: translateY(0) scale(1);
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
        }

        .modal-title {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .modal-avatar {
            font-size: 32px;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(15, 23, 42, 0.05);
            border-radius: var(--radius-md);
        }

        .modal-info h3 {
            font-size: 24px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .modal-role {
            font-size: 14px;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--text-muted);
            cursor: pointer;
            padding: 8px;
            border-radius: var(--radius-sm);
            transition: all 0.2s ease;
        }

        .modal-close:hover {
            background: rgba(15, 23, 42, 0.1);
            color: var(--text-primary);
        }

        .modal-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .modal-section {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .modal-section-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .modal-section-content {
            font-size: 16px;
            color: var(--text-primary);
            line-height: 1.5;
        }

        .modal-status-badge {
            display: inline-block;
            font-size: 12px;
            font-weight: 600;
            padding: 6px 12px;
            border-radius: 20px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .modal-time {
            font-size: 18px;
            font-weight: 600;
            color: var(--color-apomac);
        }

        .modal-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            padding: 20px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
        }

        .modal-stat {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .modal-stat-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .modal-stat-label {
            font-size: 12px;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .modal-tasks-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .modal-task-item {
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-sm);
            font-size: 14px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .task-item-status { font-size: 16px; flex-shrink: 0; }
        .task-item-text { flex: 1; }
        .task-item-time { font-size: 12px; color: var(--text-tertiary); font-weight: 600; white-space: nowrap; }

        /* â”€â”€ Wide Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .modal-wide { max-width: 640px; }

        /* â”€â”€ Meta Bar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .modal-meta-bar {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
        }

        .modal-priority {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .modal-origin {
            font-size: 12px;
            color: var(--text-tertiary);
            margin-left: auto;
        }

        /* â”€â”€ Original Request â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .modal-original-request {
            font-size: 15px;
            color: var(--text-primary);
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border-left: 3px solid var(--color-apomac);
            border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
            font-style: italic;
        }

        /* â”€â”€ Discussion Thread â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .modal-discussion {
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-height: 200px;
            overflow-y: auto;
            padding-right: 4px;
        }

        .discussion-msg {
            padding: 10px 14px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-sm);
        }

        .discussion-meta {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
        }

        .discussion-who {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .discussion-time {
            font-size: 11px;
            color: var(--text-muted);
        }

        .discussion-text {
            font-size: 14px;
            color: var(--text-primary);
            line-height: 1.4;
        }

        /* â”€â”€ Sub-agents â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .modal-subagents {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .subagent-row {
            display: grid;
            grid-template-columns: 100px 1fr auto 50px;
            gap: 8px;
            align-items: center;
            padding: 8px 14px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-sm);
            font-size: 13px;
        }

        .subagent-name { font-weight: 600; color: var(--text-primary); }
        .subagent-role { color: var(--text-secondary); }
        .subagent-status { font-size: 12px; }
        .subagent-duration { font-size: 12px; color: var(--text-tertiary); text-align: right; }

        /* â”€â”€ Files â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .modal-files {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .file-row {
            display: grid;
            grid-template-columns: 20px 1fr auto 60px;
            gap: 8px;
            align-items: center;
            padding: 8px 14px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-sm);
            font-size: 13px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .file-row:hover { background: var(--border-medium); }
        .file-icon { font-size: 14px; }
        .file-name { font-weight: 500; color: var(--text-primary); }
        .file-path { font-size: 11px; color: var(--text-muted); font-family: monospace; }
        .file-size { font-size: 11px; color: var(--text-tertiary); text-align: right; }

        /* â”€â”€ Tags â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .modal-tags {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .modal-tag {
            font-size: 11px;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 12px;
            background: rgba(59, 130, 246, 0.08);
            color: var(--color-apomac);
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        /* â”€â”€ Agent Config â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .modal-config {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .config-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 14px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-sm);
            font-size: 13px;
        }

        .config-label { color: var(--text-tertiary); }
        .config-value { font-weight: 600; color: var(--text-primary); }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           Responsive Design
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        @media (max-width: 1400px) {
            .main-grid {
                grid-template-columns: 1.5fr 1fr;
            }
        }

        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr;
                grid-template-rows: 1fr auto;
            }
            
            .agent-grid {
                grid-template-columns: repeat(3, 1fr);
                grid-template-rows: repeat(2, 1fr);
                height: 300px;
            }
        }

        @media (max-width: 900px) {
            .kanban {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .stats-bar {
                padding: 16px 24px;
            }
            
            .stats-item {
                gap: 2px;
            }
            
            .stats-value {
                font-size: 24px;
            }
        }

        @media (max-width: 600px) {
            .dashboard {
                padding: 16px;
                gap: 16px;
            }
            
            .agent-grid {
                grid-template-columns: 1fr;
                grid-template-rows: repeat(6, auto);
                height: auto;
            }
            
            .pipeline-flow {
                flex-direction: column;
                height: auto;
                gap: 16px;
            }
            
            .pipeline-connector {
                width: 2px;
                height: 20px;
                margin: 8px 0;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard fade-in">
        <!-- Stats Bar -->
        <div class="stats-bar">
            <div class="stats-item">
                <div class="stats-value highlight">47</div>
                <div class="stats-label">Tasks Today</div>
            </div>
            <div class="stats-item">
                <div class="stats-value">5<span style="color: var(--text-tertiary);">/6</span></div>
                <div class="stats-label">Active Agents</div>
            </div>
            <div class="stats-item">
                <div class="stats-value highlight">94%</div>
                <div class="stats-label">Success Rate</div>
            </div>
            <div class="stats-item">
                <div class="stats-value">12<span style="color: var(--text-tertiary);">m</span></div>
                <div class="stats-label">Avg Time</div>
            </div>
        </div>

        <!-- Main Grid -->
        <div class="main-grid">
            <!-- Left Panel: Active Workstreams -->
            <div class="left-panel">
                <div class="workstreams">
                    <div class="workstreams-header">
                        <h2 class="workstreams-title">Active Workstreams</h2>
                        <p class="workstreams-subtitle">Real-time task orchestration across all agents</p>
                    </div>
                    <div class="kanban">
                        <!-- Queued Column -->
                        <div class="kanban-column">
                            <div class="column-header">
                                <span>ğŸ“‹</span>
                                <span class="column-title">Queued</span>
                                <span class="column-count">3</span>
                            </div>
                            <div class="column-tasks">
                                <div class="task-card">
                                    <div class="task-header">
                                        <span class="agent-avatar">ğŸ”¨</span>
                                        <span class="agent-name">Forge</span>
                                        <span class="task-time">2m</span>
                                    </div>
                                    <div class="task-description">Deploy FleetKit v2.1 to production servers</div>
                                    <span class="task-status status-queued">Queued</span>
                                </div>
                                <div class="task-card">
                                    <div class="task-header">
                                        <span class="agent-avatar">ğŸ“¢</span>
                                        <span class="agent-name">Echo</span>
                                        <span class="task-time">5m</span>
                                    </div>
                                    <div class="task-description">Create social media campaign for Q1 launch</div>
                                    <span class="task-status status-queued">Queued</span>
                                </div>
                                <div class="task-card">
                                    <div class="task-header">
                                        <span class="agent-avatar">ğŸ“Š</span>
                                        <span class="agent-name">Atlas</span>
                                        <span class="task-time">1m</span>
                                    </div>
                                    <div class="task-description">Generate quarterly performance reports</div>
                                    <span class="task-status status-queued">Queued</span>
                                </div>
                            </div>
                        </div>

                        <!-- In Progress Column -->
                        <div class="kanban-column">
                            <div class="column-header">
                                <span>ğŸ”„</span>
                                <span class="column-title">In Progress</span>
                                <span class="column-count">4</span>
                            </div>
                            <div class="column-tasks">
                                <div class="task-card">
                                    <div class="task-header">
                                        <span class="agent-avatar">ğŸ</span>
                                        <span class="agent-name">ApoMac</span>
                                        <span class="task-time pulse">18m</span>
                                    </div>
                                    <div class="task-description">Review and approve new agent recruitment strategy</div>
                                    <span class="task-status status-progress">In Progress</span>
                                </div>
                                <div class="task-card">
                                    <div class="task-header">
                                        <span class="agent-avatar">ğŸ¯</span>
                                        <span class="agent-name">Hunter</span>
                                        <span class="task-time pulse">12m</span>
                                    </div>
                                    <div class="task-description">Analyze competitor pricing models for B2B SaaS</div>
                                    <span class="task-status status-progress">In Progress</span>
                                </div>
                                <div class="task-card">
                                    <div class="task-header">
                                        <span class="agent-avatar">ğŸ›¡ï¸</span>
                                        <span class="agent-name">Sentinel</span>
                                        <span class="task-time pulse">8m</span>
                                    </div>
                                    <div class="task-description">Security audit of new API endpoints</div>
                                    <span class="task-status status-progress">In Progress</span>
                                </div>
                                <div class="task-card">
                                    <div class="task-header">
                                        <span class="agent-avatar">ğŸ“Š</span>
                                        <span class="agent-name">Atlas</span>
                                        <span class="task-time pulse">25m</span>
                                    </div>
                                    <div class="task-description">Optimize resource allocation across departments</div>
                                    <span class="task-status status-progress">In Progress</span>
                                </div>
                            </div>
                        </div>

                        <!-- Done Column -->
                        <div class="kanban-column">
                            <div class="column-header">
                                <span>âœ…</span>
                                <span class="column-title">Done</span>
                                <span class="column-count">6</span>
                            </div>
                            <div class="column-tasks">
                                <div class="task-card">
                                    <div class="task-header">
                                        <span class="agent-avatar">ğŸ“¢</span>
                                        <span class="agent-name">Echo</span>
                                        <span class="task-time">1h</span>
                                    </div>
                                    <div class="task-description">Launch email campaign to 10K+ subscribers</div>
                                    <span class="task-status status-done">Completed</span>
                                </div>
                                <div class="task-card">
                                    <div class="task-header">
                                        <span class="agent-avatar">ğŸ”¨</span>
                                        <span class="agent-name">Forge</span>
                                        <span class="task-time">2h</span>
                                    </div>
                                    <div class="task-description">Fix critical bugs in user authentication</div>
                                    <span class="task-status status-done">Completed</span>
                                </div>
                                <div class="task-card">
                                    <div class="task-header">
                                        <span class="agent-avatar">ğŸ¯</span>
                                        <span class="agent-name">Hunter</span>
                                        <span class="task-time">3h</span>
                                    </div>
                                    <div class="task-description">Close 3 high-value enterprise deals</div>
                                    <span class="task-status status-done">Completed</span>
                                </div>
                            </div>
                        </div>

                        <!-- Failed Column -->
                        <div class="kanban-column">
                            <div class="column-header">
                                <span>âŒ</span>
                                <span class="column-title">Failed</span>
                                <span class="column-count">1</span>
                            </div>
                            <div class="column-tasks">
                                <div class="task-card">
                                    <div class="task-header">
                                        <span class="agent-avatar">ğŸ”¨</span>
                                        <span class="agent-name">Forge</span>
                                        <span class="task-time">4h</span>
                                    </div>
                                    <div class="task-description">Integrate third-party payment gateway</div>
                                    <span class="task-status status-failed">Failed</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Panel -->
            <div class="right-panel">
                <!-- Agent Status Grid -->
                <div class="agent-grid">
                    <div class="agent-card apomac">
                        <div class="agent-header">
                            <div class="agent-avatar-large">ğŸ</div>
                            <div class="agent-info">
                                <h3>ApoMac</h3>
                                <div class="agent-role">CEO</div>
                            </div>
                        </div>
                        <div class="agent-current-task">
                            Reviewing Q1 strategic initiatives and resource allocation plans
                        </div>
                        <div class="agent-stats">
                            <div class="stat-item">
                                <div class="stat-value">12</div>
                                <div class="stat-label">Today</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">98%</div>
                                <div class="stat-label">Success</div>
                            </div>
                        </div>
                    </div>

                    <div class="agent-card forge">
                        <div class="agent-header">
                            <div class="agent-avatar-large">ğŸ”¨</div>
                            <div class="agent-info">
                                <h3>Forge</h3>
                                <div class="agent-role">CTO</div>
                            </div>
                        </div>
                        <div class="agent-current-task">
                            Implementing new microservices architecture for better scalability
                        </div>
                        <div class="agent-stats">
                            <div class="stat-item">
                                <div class="stat-value">8</div>
                                <div class="stat-label">Today</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">85%</div>
                                <div class="stat-label">Success</div>
                            </div>
                        </div>
                    </div>

                    <div class="agent-card hunter">
                        <div class="agent-header">
                            <div class="agent-avatar-large">ğŸ¯</div>
                            <div class="agent-info">
                                <h3>Hunter</h3>
                                <div class="agent-role">CRO</div>
                            </div>
                        </div>
                        <div class="agent-current-task">
                            Negotiating partnerships with 5 major enterprise clients
                        </div>
                        <div class="agent-stats">
                            <div class="stat-item">
                                <div class="stat-value">15</div>
                                <div class="stat-label">Today</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">92%</div>
                                <div class="stat-label">Success</div>
                            </div>
                        </div>
                    </div>

                    <div class="agent-card echo">
                        <div class="agent-header">
                            <div class="agent-avatar-large">ğŸ“¢</div>
                            <div class="agent-info">
                                <h3>Echo</h3>
                                <div class="agent-role">CMO</div>
                            </div>
                        </div>
                        <div class="agent-current-task">
                            Creating content strategy for product launch campaign
                        </div>
                        <div class="agent-stats">
                            <div class="stat-item">
                                <div class="stat-value">9</div>
                                <div class="stat-label">Today</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">97%</div>
                                <div class="stat-label">Success</div>
                            </div>
                        </div>
                    </div>

                    <div class="agent-card sentinel">
                        <div class="agent-header">
                            <div class="agent-avatar-large">ğŸ›¡ï¸</div>
                            <div class="agent-info">
                                <h3>Sentinel</h3>
                                <div class="agent-role">Auditor</div>
                            </div>
                        </div>
                        <div class="agent-current-task">
                            Conducting comprehensive security review of all systems
                        </div>
                        <div class="agent-stats">
                            <div class="stat-item">
                                <div class="stat-value">6</div>
                                <div class="stat-label">Today</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">100%</div>
                                <div class="stat-label">Success</div>
                            </div>
                        </div>
                    </div>

                    <div class="agent-card atlas" style="opacity: 0.6;">
                        <div class="agent-header">
                            <div class="agent-avatar-large">ğŸ“Š</div>
                            <div class="agent-info">
                                <h3>Atlas</h3>
                                <div class="agent-role">COO</div>
                            </div>
                        </div>
                        <div class="agent-current-task" style="color: var(--text-muted);">
                            Currently offline - scheduled maintenance
                        </div>
                        <div class="agent-stats">
                            <div class="stat-item">
                                <div class="stat-value" style="color: var(--text-muted);">3</div>
                                <div class="stat-label">Today</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" style="color: var(--text-muted);">89%</div>
                                <div class="stat-label">Success</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pipeline Flow -->
                <div class="pipeline">
                    <div class="pipeline-header">
                        <h3 class="pipeline-title">Pipeline Flow</h3>
                        <p class="pipeline-subtitle">Task progression through orchestration stages</p>
                    </div>
                    <div class="pipeline-flow">
                        <div class="pipeline-stage">
                            <div class="stage-name">Request</div>
                            <div class="stage-dot completed"></div>
                        </div>
                        <div class="pipeline-connector active">
                            <div class="task-indicator"></div>
                        </div>
                        <div class="pipeline-stage">
                            <div class="stage-name">Assignment</div>
                            <div class="stage-dot completed"></div>
                        </div>
                        <div class="pipeline-connector active"></div>
                        <div class="pipeline-stage">
                            <div class="stage-name">Execution</div>
                            <div class="stage-dot active pulse"></div>
                        </div>
                        <div class="pipeline-connector"></div>
                        <div class="pipeline-stage">
                            <div class="stage-name">Review</div>
                            <div class="stage-dot"></div>
                        </div>
                        <div class="pipeline-connector"></div>
                        <div class="pipeline-stage">
                            <div class="stage-name">Delivery</div>
                            <div class="stage-dot"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // CEO Orchestration Dashboard â€” Interactive Logic
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        // Theme Bridge Setup
        document.addEventListener('DOMContentLoaded', function() {
            // Signal that dashboard is ready
            if (window.parent !== window) {
                parent.postMessage({type:'theme:ready'}, '*');
            }

            // Listen for data updates from parent
            window.addEventListener('message', function(event) {
                if (event.data && event.data.type === 'data:update') {
                    updateDashboard(event.data.payload);
                }
            });

            // Initialize animations and interactions
            initializeDashboard();
        });

        function initializeDashboard() {
            // Add hover effects and click handlers to task cards
            const taskCards = document.querySelectorAll('.task-card');
            taskCards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-2px)';
                });
                
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                });

                // Add click handler for task detail modal
                card.addEventListener('click', function() {
                    const task = extractTaskData(this);
                    showTaskDetail(task);
                });
            });

            // Add click handlers for agent cards
            const agentCards = document.querySelectorAll('.agent-card');
            agentCards.forEach(card => {
                card.addEventListener('click', function() {
                    const agent = extractAgentData(this);
                    showAgentDetail(agent);
                });
            });

            // Animate stats values on load
            animateStatsCounter();

            // Start pipeline animations
            startPipelineAnimations();

            // Auto-refresh mock data every 8-15 seconds (feels alive)
            function scheduleNext() {
                const delay = 8000 + Math.random() * 7000; // 8-15s
                setTimeout(() => { updateMockData(); scheduleNext(); }, delay);
            }
            scheduleNext();
        }

        function animateStatsCounter() {
            const statValues = document.querySelectorAll('.stats-value');
            statValues.forEach(stat => {
                const finalValue = parseInt(stat.textContent);
                if (isNaN(finalValue)) return;

                let currentValue = 0;
                const increment = finalValue / 30;
                const timer = setInterval(() => {
                    currentValue += increment;
                    if (currentValue >= finalValue) {
                        currentValue = finalValue;
                        clearInterval(timer);
                    }
                    stat.textContent = Math.floor(currentValue);
                    if (stat.textContent.includes('%')) {
                        stat.innerHTML = Math.floor(currentValue) + '<span style="color: var(--text-tertiary);">%</span>';
                    }
                }, 50);
            });
        }

        function startPipelineAnimations() {
            const activeConnectors = document.querySelectorAll('.pipeline-connector.active');
            activeConnectors.forEach((connector, index) => {
                setTimeout(() => {
                    connector.style.animation = 'flowProgress 3s ease-in-out infinite';
                }, index * 500);
            });
        }

        // Column index mapping
        const COLUMN_STATUS = ['Queued', 'In Progress', 'Completed', 'Failed'];
        const STATUS_CLASSES = { 'Queued': 'status-queued', 'In Progress': 'status-progress', 'Completed': 'status-done', 'Failed': 'status-failed' };

        function getColumns() {
            return document.querySelectorAll('.kanban-column');
        }

        function moveTaskToNextColumn(card, fromCol, toCol, newStatus) {
            // Animate leaving
            card.classList.add('leaving');

            setTimeout(() => {
                // Remove from old column
                card.remove();

                // Update card status
                const statusEl = card.querySelector('.task-status');
                if (statusEl) {
                    statusEl.textContent = newStatus;
                    statusEl.className = 'task-status ' + (STATUS_CLASSES[newStatus] || '');
                }

                // Add to new column
                const targetTasks = toCol.querySelector('.column-tasks');
                card.classList.remove('leaving');
                card.classList.add('just-moved');
                targetTasks.prepend(card);

                // Update column counts
                updateColumnCounts();

                // Remove animation class after it completes
                setTimeout(() => card.classList.remove('just-moved'), 900);
            }, 500);
        }

        function updateColumnCounts() {
            getColumns().forEach(col => {
                const count = col.querySelector('.column-tasks').children.length;
                const countEl = col.querySelector('.column-count');
                if (countEl) countEl.textContent = count;
            });
        }

        function updateMockData() {
            const columns = getColumns();
            if (columns.length < 3) return;

            // Increment time on in-progress tasks
            const progressCol = columns[1];
            progressCol.querySelectorAll('.task-time').forEach(el => {
                const mins = parseInt(el.textContent);
                if (!isNaN(mins)) el.textContent = (mins + 1) + 'm';
            });

            // Random chance to move a task forward
            const roll = Math.random();

            if (roll < 0.35) {
                // Move a queued â†’ in progress
                const queuedCards = columns[0].querySelectorAll('.task-card');
                if (queuedCards.length > 0) {
                    const card = queuedCards[Math.floor(Math.random() * queuedCards.length)];
                    moveTaskToNextColumn(card, columns[0], columns[1], 'In Progress');
                }
            } else if (roll < 0.7) {
                // Move an in-progress â†’ done
                const progressCards = columns[1].querySelectorAll('.task-card');
                if (progressCards.length > 0) {
                    const card = progressCards[Math.floor(Math.random() * progressCards.length)];
                    moveTaskToNextColumn(card, columns[1], columns[2], 'Completed');

                    // Update stats
                    const tasksToday = document.querySelector('.stats-value.highlight');
                    if (tasksToday) {
                        tasksToday.textContent = parseInt(tasksToday.textContent) + 1;
                    }
                }
            } else if (roll < 0.78) {
                // Rare: move in-progress â†’ failed
                const progressCards = columns[1].querySelectorAll('.task-card');
                if (progressCards.length > 1) {
                    const card = progressCards[Math.floor(Math.random() * progressCards.length)];
                    moveTaskToNextColumn(card, columns[1], columns[3], 'Failed');
                }
            }

            // Occasionally add a new queued task
            if (Math.random() < 0.25 && columns[0].querySelectorAll('.task-card').length < 5) {
                addNewQueuedTask(columns[0]);
            }
        }

        const NEW_TASK_POOL = [
            { agent: 'ğŸ”¨', name: 'Forge', task: 'Optimize database query performance' },
            { agent: 'ğŸ“¢', name: 'Echo', task: 'Draft product announcement blog post' },
            { agent: 'ğŸ¯', name: 'Hunter', task: 'Research new market opportunities in APAC' },
            { agent: 'ğŸ“Š', name: 'Atlas', task: 'Generate weekly infrastructure cost report' },
            { agent: 'ğŸ›¡ï¸', name: 'Sentinel', task: 'Run penetration test on staging environment' },
            { agent: 'ğŸ', name: 'ApoMac', task: 'Review and prioritize Sprint 2 backlog' },
            { agent: 'ğŸ”¨', name: 'Forge', task: 'Implement WebSocket real-time sync layer' },
            { agent: 'ğŸ“¢', name: 'Echo', task: 'Create onboarding tutorial video script' },
            { agent: 'ğŸ¯', name: 'Hunter', task: 'Prepare enterprise proposal for TechCorp deal' },
            { agent: 'ğŸ›¡ï¸', name: 'Sentinel', task: 'Audit third-party dependency vulnerabilities' },
        ];

        function addNewQueuedTask(queuedCol) {
            const t = NEW_TASK_POOL[Math.floor(Math.random() * NEW_TASK_POOL.length)];
            const card = document.createElement('div');
            card.className = 'task-card just-moved';
            card.innerHTML = `
                <div class="task-header">
                    <div class="agent-avatar">${t.agent}</div>
                    <div class="agent-name">${t.name}</div>
                    <div class="task-time">0m</div>
                </div>
                <div class="task-description">${t.task}</div>
                <div class="task-status status-queued">Queued</div>
            `;
            card.style.cursor = 'pointer';
            card.addEventListener('click', function() {
                const taskData = extractTaskData(this);
                showTaskDetail(taskData);
            });
            queuedCol.querySelector('.column-tasks').prepend(card);
            updateColumnCounts();
            setTimeout(() => card.classList.remove('just-moved'), 900);
        }

        function updateDashboard(data) {
            // Handle real-time updates from parent frame
            if (data.stats) {
                updateStats(data.stats);
            }
            
            if (data.tasks) {
                updateTasks(data.tasks);
            }
            
            if (data.agents) {
                updateAgents(data.agents);
            }
        }

        function updateStats(stats) {
            const elements = {
                tasks: document.querySelector('.stats-item:nth-child(1) .stats-value'),
                active: document.querySelector('.stats-item:nth-child(2) .stats-value'),
                success: document.querySelector('.stats-item:nth-child(3) .stats-value'),
                avgTime: document.querySelector('.stats-item:nth-child(4) .stats-value')
            };

            if (stats.tasksToday && elements.tasks) {
                elements.tasks.textContent = stats.tasksToday;
            }
            
            if (stats.activeAgents && elements.active) {
                elements.active.innerHTML = `${stats.activeAgents}<span style="color: var(--text-tertiary);">/6</span>`;
            }
            
            if (stats.successRate && elements.success) {
                elements.success.textContent = stats.successRate + '%';
            }
            
            if (stats.avgTime && elements.avgTime) {
                elements.avgTime.innerHTML = `${stats.avgTime}<span style="color: var(--text-tertiary);">m</span>`;
            }
        }

        function updateTasks(tasks) {
            // Update kanban columns with new task data
            console.log('Updating tasks:', tasks);
            // Implementation depends on data structure
        }

        function updateAgents(agents) {
            // Update agent status cards with new data
            console.log('Updating agents:', agents);
            // Implementation depends on data structure
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // Rich Task & Agent Data (mock â€” wired to real data via data-bridge)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        const TASK_DETAILS = {
            'Deploy FleetKit v2.1 to production servers': {
                id: 'TASK-047',
                origin: 'ğŸ’¬ Kira via Telegram',
                originalRequest: 'Deploy la v2.1 en prod, teste bien avant',
                priority: 'ğŸ”´ Critique',
                createdAt: '18:12',
                discussion: [
                    { who: 'ğŸ ApoMac', time: '18:13', msg: 'ReÃ§u. Sentinel audit avant deploy.' },
                    { who: 'ğŸ›¡ï¸ Sentinel', time: '18:15', msg: 'Audit OK â€” pas de failles critiques, 2 warnings mineurs (logs verbeux).' },
                    { who: 'ğŸ ApoMac', time: '18:16', msg: 'AssignÃ© Ã  Forge. Go deploy.' },
                ],
                subAgents: [
                    { name: 'Sentinel', role: 'Pre-deploy audit', status: 'âœ… Done', duration: '2m' },
                    { name: 'Forge', role: 'Build & deploy', status: 'ğŸ“‹ Queued', duration: 'â€”' },
                ],
                files: [
                    { name: 'fleetkit-v2.1-bundle.js', path: '/dist/', size: '284 KB' },
                    { name: 'deploy-manifest.json', path: '/config/', size: '1.2 KB' },
                    { name: 'sentinel-audit-047.md', path: '/audits/', size: '3.4 KB' },
                ],
                tags: ['deploy', 'production', 'v2.1'],
            },
            'Create social media campaign for Q1 launch': {
                id: 'TASK-044',
                origin: 'ğŸ“‹ TODO.md auto-pick',
                originalRequest: 'PrÃ©parer campagne rÃ©seaux sociaux pour le lancement Q1 â€” visuels + copy + planning',
                priority: 'ğŸŸ¡ Medium',
                createdAt: '17:30',
                discussion: [
                    { who: 'ğŸ ApoMac', time: '17:31', msg: 'Echo, tu prends le lead. Target: LinkedIn + Twitter + ProductHunt.' },
                    { who: 'ğŸ“¢ Echo', time: '17:32', msg: 'Copy. Je prÃ©pare 3 visuels + calendrier Ã©ditorial.' },
                ],
                subAgents: [
                    { name: 'Echo', role: 'Content creation', status: 'ğŸ“‹ Queued', duration: 'â€”' },
                ],
                files: [
                    { name: 'campaign-brief.md', path: '/marketing/', size: '2.1 KB' },
                ],
                tags: ['marketing', 'Q1', 'social'],
            },
            'Generate quarterly performance reports': {
                id: 'TASK-046',
                origin: 'â° Cron automatique',
                originalRequest: 'Rapport trimestriel de performance â€” agents, coÃ»ts, revenus, KPIs',
                priority: 'ğŸŸ¢ Low',
                createdAt: '18:00',
                discussion: [
                    { who: 'ğŸ ApoMac', time: '18:01', msg: 'Atlas, rapport standard Q1. Focus sur les coÃ»ts API.' },
                ],
                subAgents: [],
                files: [
                    { name: 'q4-report-template.md', path: '/reports/', size: '5.6 KB' },
                ],
                tags: ['reporting', 'quarterly', 'KPI'],
            },
            'Review and approve new agent recruitment strategy': {
                id: 'TASK-041',
                origin: 'ğŸ’¬ Kira via Telegram',
                originalRequest: 'Revois la stratÃ©gie de recrutement des nouveaux agents â€” on scale ou pas ?',
                priority: 'ğŸ”´ Critique',
                createdAt: '17:35',
                discussion: [
                    { who: 'ğŸ ApoMac', time: '17:36', msg: 'Je prends en direct. Analyse coÃ»t/bÃ©nÃ©fice en cours.' },
                    { who: 'ğŸ ApoMac', time: '17:42', msg: 'RÃ©sultat : 3 agents suffisent pour la charge actuelle. Scale Ã  5 si revenue > â‚¬5K/mo.' },
                    { who: 'ğŸ ApoMac', time: '17:50', msg: 'Draft de la stratÃ©gie envoyÃ© Ã  Kira pour validation.' },
                ],
                subAgents: [
                    { name: 'Hunter', role: 'Market analysis', status: 'âœ… Done', duration: '8m' },
                    { name: 'Atlas', role: 'Cost modeling', status: 'âœ… Done', duration: '5m' },
                ],
                files: [
                    { name: 'agent-scaling-strategy.md', path: '/strategy/', size: '4.2 KB' },
                    { name: 'cost-model-q1.xlsx', path: '/finance/', size: '12 KB' },
                ],
                tags: ['strategy', 'scaling', 'agents'],
            },
            'Analyze competitor pricing models for B2B SaaS': {
                id: 'TASK-039',
                origin: 'ğŸ§  ApoMac initiative',
                originalRequest: 'Recherche pricing B2B SaaS concurrents pour positionner Personal AI Assistant Pro',
                priority: 'ğŸŸ¡ Medium',
                createdAt: '17:41',
                discussion: [
                    { who: 'ğŸ ApoMac', time: '17:42', msg: 'Hunter, scan les 10 top concurrents. Focus: pricing, features, target.' },
                    { who: 'ğŸ¯ Hunter', time: '17:45', msg: 'En cours. DÃ©jÃ  6 analysÃ©s. Range: $29-$299/mo.' },
                    { who: 'ğŸ¯ Hunter', time: '17:53', msg: 'Sweet spot identifiÃ©: â‚¬99-199/mo pour premium personal AI.' },
                ],
                subAgents: [],
                files: [
                    { name: 'competitor-matrix.md', path: '/research/', size: '8.7 KB' },
                    { name: 'pricing-benchmark.csv', path: '/research/', size: '3.1 KB' },
                ],
                tags: ['pricing', 'research', 'B2B'],
            },
            'Security audit of new API endpoints': {
                id: 'TASK-043',
                origin: 'ğŸ›¡ï¸ Sentinel auto-trigger',
                originalRequest: 'Audit sÃ©curitÃ© des nouveaux endpoints API SpawnKit â€” auth, rate-limiting, injection',
                priority: 'ğŸ”´ Critique',
                createdAt: '17:45',
                discussion: [
                    { who: 'ğŸ›¡ï¸ Sentinel', time: '17:46', msg: 'Scan en cours. 12 endpoints identifiÃ©s.' },
                    { who: 'ğŸ›¡ï¸ Sentinel', time: '17:50', msg: '3 endpoints sans rate-limiting. 1 vulnÃ©rabilitÃ© CORS potentielle.' },
                    { who: 'ğŸ ApoMac', time: '17:51', msg: 'Forge, fix les 3 endpoints. CORS = prioritÃ© 1.' },
                ],
                subAgents: [
                    { name: 'Forge', role: 'Fix endpoints', status: 'ğŸ”„ In Progress', duration: '6m' },
                ],
                files: [
                    { name: 'security-audit-043.md', path: '/audits/', size: '6.3 KB' },
                    { name: 'endpoint-inventory.json', path: '/api/', size: '2.1 KB' },
                ],
                tags: ['security', 'API', 'audit'],
            },
            'Optimize resource allocation across departments': {
                id: 'TASK-038',
                origin: 'ğŸ“‹ TODO.md auto-pick',
                originalRequest: 'Optimiser l\'allocation des ressources â€” quel agent fait quoi, parallÃ©lisation, bottlenecks',
                priority: 'ğŸŸ¡ Medium',
                createdAt: '17:28',
                discussion: [
                    { who: 'ğŸ ApoMac', time: '17:29', msg: 'Atlas, analyse la charge de chaque agent sur les 7 derniers jours.' },
                    { who: 'ğŸ“Š Atlas', time: '17:35', msg: 'Forge est Ã  87% de charge, Echo Ã  34%. DÃ©sÃ©quilibre notable.' },
                    { who: 'ğŸ“Š Atlas', time: '17:48', msg: 'Recommandation: redistribuer 2 tÃ¢ches build de Forge vers un nouveau sub-agent spÃ©cialisÃ©.' },
                ],
                subAgents: [
                    { name: 'Atlas', role: 'Load analysis', status: 'ğŸ”„ In Progress', duration: '25m' },
                ],
                files: [
                    { name: 'resource-allocation-report.md', path: '/ops/', size: '5.8 KB' },
                    { name: 'agent-load-7d.json', path: '/metrics/', size: '1.4 KB' },
                ],
                tags: ['ops', 'allocation', 'optimization'],
            },
            'Launch email campaign to 10K+ subscribers': {
                id: 'TASK-035',
                origin: 'ğŸ’¬ Kira via Telegram',
                originalRequest: 'Lance la campagne email â€” liste de 10K subs, template validÃ© hier',
                priority: 'ğŸŸ¡ Medium',
                createdAt: '16:20',
                discussion: [
                    { who: 'ğŸ“¢ Echo', time: '16:22', msg: 'Template chargÃ©. A/B test sur 2 subject lines.' },
                    { who: 'ğŸ“¢ Echo', time: '16:45', msg: 'Envoi terminÃ©. Open rate preview: 34%.' },
                    { who: 'ğŸ ApoMac', time: '16:46', msg: 'Bon taux. Rapport dans 24h.' },
                ],
                subAgents: [],
                files: [
                    { name: 'email-template-v3.html', path: '/marketing/', size: '18 KB' },
                    { name: 'send-report.json', path: '/marketing/', size: '0.8 KB' },
                ],
                tags: ['email', 'campaign', 'marketing'],
            },
            'Fix critical bugs in user authentication': {
                id: 'TASK-033',
                origin: 'ğŸ›¡ï¸ Sentinel alert',
                originalRequest: 'Bug critique auth â€” tokens JWT pas invalidÃ©s aprÃ¨s logout',
                priority: 'ğŸ”´ Critique',
                createdAt: '14:10',
                discussion: [
                    { who: 'ğŸ›¡ï¸ Sentinel', time: '14:11', msg: 'VulnÃ©rabilitÃ© confirmÃ©e. Tokens persistent 24h aprÃ¨s logout.' },
                    { who: 'ğŸ”¨ Forge', time: '14:15', msg: 'Fix en cours. Ajout blacklist Redis + rotation des secrets.' },
                    { who: 'ğŸ”¨ Forge', time: '15:50', msg: 'Fix deployed. Tests passent. Token invalidation < 1s.' },
                    { who: 'ğŸ›¡ï¸ Sentinel', time: '15:55', msg: 'Re-audit OK. VulnÃ©rabilitÃ© fermÃ©e.' },
                ],
                subAgents: [
                    { name: 'Sentinel', role: 'Pre/post audit', status: 'âœ… Done', duration: '12m' },
                ],
                files: [
                    { name: 'auth-fix.patch', path: '/patches/', size: '4.5 KB' },
                    { name: 'jwt-blacklist.ts', path: '/src/auth/', size: '2.8 KB' },
                ],
                tags: ['bugfix', 'security', 'auth'],
            },
            'Close 3 high-value enterprise deals': {
                id: 'TASK-031',
                origin: 'ğŸ¯ Hunter initiative',
                originalRequest: 'Closer 3 deals enterprise identifiÃ©s la semaine derniÃ¨re â€” Acme Corp, TechFlow, DataSync',
                priority: 'ğŸ”´ Critique',
                createdAt: '12:00',
                discussion: [
                    { who: 'ğŸ¯ Hunter', time: '12:05', msg: 'Acme Corp â€” call prÃ©vu 14h. Proposal envoyÃ©.' },
                    { who: 'ğŸ¯ Hunter', time: '14:30', msg: 'Acme Corp âœ… â€” deal signÃ© â‚¬2.4K/mo.' },
                    { who: 'ğŸ¯ Hunter', time: '15:15', msg: 'TechFlow âœ… â€” â‚¬1.8K/mo. DataSync en nÃ©gociation.' },
                    { who: 'ğŸ¯ Hunter', time: '16:45', msg: 'DataSync âœ… â€” â‚¬3.2K/mo. 3/3 closed. Total: +â‚¬7.4K MRR.' },
                    { who: 'ğŸ ApoMac', time: '16:46', msg: 'ğŸ”¥ Excellent. On approche les â‚¬10K/mo.' },
                ],
                subAgents: [
                    { name: 'Echo', role: 'Proposal design', status: 'âœ… Done', duration: '20m' },
                ],
                files: [
                    { name: 'deal-acme-corp.md', path: '/deals/', size: '3.2 KB' },
                    { name: 'deal-techflow.md', path: '/deals/', size: '2.8 KB' },
                    { name: 'deal-datasync.md', path: '/deals/', size: '3.5 KB' },
                ],
                tags: ['sales', 'enterprise', 'closed'],
            },
            'Integrate third-party payment gateway': {
                id: 'TASK-029',
                origin: 'ğŸ“‹ TODO.md Sprint 2',
                originalRequest: 'IntÃ©grer Stripe Connect pour les paiements marketplace â€” split payments + webhooks',
                priority: 'ğŸŸ¡ Medium',
                createdAt: '10:00',
                discussion: [
                    { who: 'ğŸ”¨ Forge', time: '10:05', msg: 'Stripe Connect setup en cours. OAuth flow + webhooks.' },
                    { who: 'ğŸ”¨ Forge', time: '12:30', msg: 'OAuth flow OK mais webhook signature verification Ã©choue en staging.' },
                    { who: 'ğŸ”¨ Forge', time: '13:45', msg: 'Debug: endpoint secret mismatch entre .env et Stripe dashboard.' },
                    { who: 'ğŸ”¨ Forge', time: '14:20', msg: 'âŒ BloquÃ© â€” Stripe Connect nÃ©cessite validation business (KYC). Pas possible sans Kira.' },
                    { who: 'ğŸ ApoMac', time: '14:22', msg: 'Mis en attente. Kira doit complÃ©ter le KYC Stripe.' },
                ],
                subAgents: [],
                files: [
                    { name: 'stripe-connect-integration.ts', path: '/src/payments/', size: '8.4 KB' },
                    { name: 'webhook-handler.ts', path: '/src/payments/', size: '3.1 KB' },
                    { name: 'stripe-error-log.txt', path: '/logs/', size: '1.2 KB' },
                ],
                tags: ['payments', 'stripe', 'blocked'],
            },
        };

        const AGENT_DETAILS = {
            'ApoMac': {
                specialties: ['Architecture', 'StratÃ©gie', 'Orchestration', 'Product'],
                model: 'Claude Opus 4',
                uptime: '99.8%',
                avgResponseTime: '4.2s',
                tokensToday: '142K',
                costToday: 'â‚¬0 (Claude Max)',
                recentTasks: [
                    { task: 'Village theme v3 â€” Canvas 2D seamless tiling', status: 'âœ…', time: '45m' },
                    { task: 'Kanban light mode + click modals', status: 'âœ…', time: '12m' },
                    { task: 'Data bridge live mode (30s polling)', status: 'âœ…', time: '25m' },
                    { task: 'Sycopa sparring coordination', status: 'ğŸ”„', time: 'â€”' },
                ],
            },
            'Forge': {
                specialties: ['Backend', 'DevOps', 'Infrastructure', 'Performance'],
                model: 'Claude Sonnet 4',
                uptime: '97.2%',
                avgResponseTime: '3.8s',
                tokensToday: '98K',
                costToday: 'â‚¬0 (Claude Max)',
                recentTasks: [
                    { task: 'Fix auth JWT invalidation bug', status: 'âœ…', time: '1h40' },
                    { task: 'Microservices architecture migration', status: 'ğŸ”„', time: 'â€”' },
                    { task: 'FleetKit v2.0 production deploy', status: 'âœ…', time: '30m' },
                    { task: 'Rate-limiting middleware', status: 'âœ…', time: '15m' },
                ],
            },
            'Hunter': {
                specialties: ['Revenue', 'Partnerships', 'Market Analysis', 'Pricing'],
                model: 'Claude Sonnet 4',
                uptime: '95.1%',
                avgResponseTime: '5.1s',
                tokensToday: '76K',
                costToday: 'â‚¬0 (Claude Max)',
                recentTasks: [
                    { task: 'Close 3 enterprise deals (+â‚¬7.4K MRR)', status: 'âœ…', time: '3h' },
                    { task: 'Competitor pricing analysis B2B SaaS', status: 'ğŸ”„', time: '12m' },
                    { task: 'Lead qualification pipeline', status: 'âœ…', time: '20m' },
                    { task: 'Partnership outreach (5 targets)', status: 'âœ…', time: '45m' },
                ],
            },
            'Echo': {
                specialties: ['Content', 'Marketing', 'Communications', 'Design'],
                model: 'Claude Sonnet 4',
                uptime: '99.1%',
                avgResponseTime: '3.2s',
                tokensToday: '54K',
                costToday: 'â‚¬0 (Claude Max)',
                recentTasks: [
                    { task: 'Email campaign 10K subscribers (34% open)', status: 'âœ…', time: '1h' },
                    { task: 'Product launch content strategy', status: 'ğŸ”„', time: 'â€”' },
                    { task: 'Landing page copy v3', status: 'âœ…', time: '25m' },
                    { task: 'Social media calendar Q1', status: 'âœ…', time: '35m' },
                ],
            },
            'Sentinel': {
                specialties: ['Security', 'Audit', 'Quality', 'Compliance'],
                model: 'Claude Opus 4',
                uptime: '100%',
                avgResponseTime: '6.4s',
                tokensToday: '38K',
                costToday: 'â‚¬0 (Claude Max)',
                recentTasks: [
                    { task: 'API endpoint security audit (12 endpoints)', status: 'ğŸ”„', time: '8m' },
                    { task: 'Pre-deploy FleetKit v2.1 audit', status: 'âœ…', time: '2m' },
                    { task: 'JWT auth vulnerability fix verification', status: 'âœ…', time: '5m' },
                    { task: 'Weekly infrastructure scan', status: 'âœ…', time: '15m' },
                ],
            },
            'Atlas': {
                specialties: ['Operations', 'Analytics', 'Resource Planning', 'Metrics'],
                model: 'Claude Sonnet 4',
                uptime: '89.3%',
                avgResponseTime: '4.8s',
                tokensToday: '22K',
                costToday: 'â‚¬0 (Claude Max)',
                recentTasks: [
                    { task: 'Resource allocation optimization', status: 'ğŸ”„', time: '25m' },
                    { task: 'Agent load analysis (7 jours)', status: 'âœ…', time: '10m' },
                    { task: 'Quarterly performance report template', status: 'ğŸ“‹', time: 'â€”' },
                    { task: 'Cost tracking dashboard data', status: 'âœ…', time: '18m' },
                ],
            },
        };

        // Extract task data from task card element
        function extractTaskData(taskCard) {
            const agentAvatar = taskCard.querySelector('.agent-avatar').textContent;
            const agentName = taskCard.querySelector('.agent-name').textContent;
            const taskTime = taskCard.querySelector('.task-time').textContent;
            const taskDescription = taskCard.querySelector('.task-description').textContent;
            const statusElement = taskCard.querySelector('.task-status');
            const status = statusElement.textContent;
            const statusClass = statusElement.className.split(' ').find(c => c.startsWith('status-'));
            
            return {
                agentAvatar,
                agentName,
                taskTime,
                taskDescription,
                status,
                statusClass,
                details: TASK_DETAILS[taskDescription] || null,
            };
        }

        // Extract agent data from agent card element
        function extractAgentData(agentCard) {
            const agentAvatar = agentCard.querySelector('.agent-avatar-large').textContent;
            const agentName = agentCard.querySelector('h3').textContent;
            const agentRole = agentCard.querySelector('.agent-role').textContent;
            const currentTask = agentCard.querySelector('.agent-current-task').textContent;
            const todayTasks = agentCard.querySelector('.stat-value:first-child').textContent;
            const successRate = agentCard.querySelector('.stat-value:last-child').textContent;
            
            return {
                agentAvatar,
                agentName,
                agentRole,
                currentTask,
                todayTasks,
                successRate,
                details: AGENT_DETAILS[agentName] || null,
            };
        }

        // Show task detail modal
        function showTaskDetail(task) {
            const modal = createTaskModal(task);
            document.body.appendChild(modal);
            
            // Show modal with animation
            requestAnimationFrame(() => {
                modal.classList.add('active');
            });
        }

        // Create task modal element
        function createTaskModal(task) {
            const overlay = document.createElement('div');
            overlay.className = 'modal-overlay';
            const d = task.details;

            // Build discussion thread
            let discussionHtml = '';
            if (d && d.discussion && d.discussion.length) {
                discussionHtml = `
                    <div class="modal-section">
                        <div class="modal-section-title">ğŸ’¬ Fil de discussion</div>
                        <div class="modal-discussion">
                            ${d.discussion.map(m => `
                                <div class="discussion-msg">
                                    <div class="discussion-meta">
                                        <span class="discussion-who">${m.who}</span>
                                        <span class="discussion-time">${m.time}</span>
                                    </div>
                                    <div class="discussion-text">${m.msg}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>`;
            }

            // Build sub-agents
            let subAgentsHtml = '';
            if (d && d.subAgents && d.subAgents.length) {
                subAgentsHtml = `
                    <div class="modal-section">
                        <div class="modal-section-title">ğŸ¤– Sous-agents</div>
                        <div class="modal-subagents">
                            ${d.subAgents.map(s => `
                                <div class="subagent-row">
                                    <span class="subagent-name">${s.name}</span>
                                    <span class="subagent-role">${s.role}</span>
                                    <span class="subagent-status">${s.status}</span>
                                    <span class="subagent-duration">${s.duration}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>`;
            }

            // Build files
            let filesHtml = '';
            if (d && d.files && d.files.length) {
                filesHtml = `
                    <div class="modal-section">
                        <div class="modal-section-title">ğŸ“ Fichiers associÃ©s</div>
                        <div class="modal-files">
                            ${d.files.map(f => `
                                <div class="file-row">
                                    <span class="file-icon">ğŸ“„</span>
                                    <span class="file-name">${f.name}</span>
                                    <span class="file-path">${f.path}</span>
                                    <span class="file-size">${f.size}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>`;
            }

            // Build tags
            let tagsHtml = '';
            if (d && d.tags && d.tags.length) {
                tagsHtml = `
                    <div class="modal-tags">
                        ${d.tags.map(t => `<span class="modal-tag">${t}</span>`).join('')}
                    </div>`;
            }

            overlay.innerHTML = `
                <div class="modal modal-wide">
                    <div class="modal-header">
                        <div class="modal-title">
                            <div class="modal-avatar">${task.agentAvatar}</div>
                            <div class="modal-info">
                                <h3>${task.agentName}</h3>
                                <div class="modal-role">${d ? d.id : 'Task'}</div>
                            </div>
                        </div>
                        <button class="modal-close" onclick="closeModal(this)">Ã—</button>
                    </div>
                    <div class="modal-content">
                        <div class="modal-meta-bar">
                            <span class="modal-status-badge ${task.statusClass}">${task.status}</span>
                            ${d ? `<span class="modal-priority">${d.priority}</span>` : ''}
                            <span class="modal-time">â± ${task.taskTime}</span>
                            ${d ? `<span class="modal-origin">${d.origin}</span>` : ''}
                        </div>

                        <div class="modal-section">
                            <div class="modal-section-title">ğŸ“‹ TÃ¢che</div>
                            <div class="modal-section-content">${task.taskDescription}</div>
                        </div>

                        ${d ? `
                        <div class="modal-section">
                            <div class="modal-section-title">ğŸ¯ Demande initiale</div>
                            <div class="modal-original-request">${d.originalRequest}</div>
                        </div>` : ''}

                        ${discussionHtml}
                        ${subAgentsHtml}
                        ${filesHtml}
                        ${tagsHtml}
                    </div>
                </div>
            `;
            
            overlay.addEventListener('click', function(e) {
                if (e.target === overlay) {
                    closeModal(overlay.querySelector('.modal-close'));
                }
            });
            
            return overlay;
        }

        // Show agent detail modal
        function showAgentDetail(agent) {
            const modal = createAgentModal(agent);
            document.body.appendChild(modal);
            
            // Show modal with animation
            requestAnimationFrame(() => {
                modal.classList.add('active');
            });
        }

        // Create agent modal element
        function createAgentModal(agent) {
            const overlay = document.createElement('div');
            overlay.className = 'modal-overlay';
            const d = agent.details;

            // Specialties
            let specialtiesHtml = '';
            if (d && d.specialties) {
                specialtiesHtml = `
                    <div class="modal-tags">
                        ${d.specialties.map(s => `<span class="modal-tag">${s}</span>`).join('')}
                    </div>`;
            }

            // Recent tasks with status
            let recentTasksHtml = '';
            if (d && d.recentTasks) {
                recentTasksHtml = `
                    <div class="modal-section">
                        <div class="modal-section-title">ğŸ“‹ TÃ¢ches rÃ©centes</div>
                        <div class="modal-tasks-list">
                            ${d.recentTasks.map(t => `
                                <div class="modal-task-item">
                                    <span class="task-item-status">${t.status}</span>
                                    <span class="task-item-text">${t.task}</span>
                                    <span class="task-item-time">${t.time}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>`;
            }

            overlay.innerHTML = `
                <div class="modal modal-wide">
                    <div class="modal-header">
                        <div class="modal-title">
                            <div class="modal-avatar">${agent.agentAvatar}</div>
                            <div class="modal-info">
                                <h3>${agent.agentName}</h3>
                                <div class="modal-role">${agent.agentRole}</div>
                            </div>
                        </div>
                        <button class="modal-close" onclick="closeModal(this)">Ã—</button>
                    </div>
                    <div class="modal-content">
                        <div class="modal-section">
                            <div class="modal-section-title">ğŸ¯ TÃ¢che en cours</div>
                            <div class="modal-section-content">${agent.currentTask}</div>
                        </div>

                        ${specialtiesHtml}

                        <div class="modal-stats">
                            <div class="modal-stat">
                                <div class="modal-stat-value">${agent.todayTasks}</div>
                                <div class="modal-stat-label">Tasks Today</div>
                            </div>
                            <div class="modal-stat">
                                <div class="modal-stat-value">${agent.successRate}</div>
                                <div class="modal-stat-label">Success Rate</div>
                            </div>
                            ${d ? `
                            <div class="modal-stat">
                                <div class="modal-stat-value">${d.uptime}</div>
                                <div class="modal-stat-label">Uptime</div>
                            </div>
                            <div class="modal-stat">
                                <div class="modal-stat-value">${d.avgResponseTime}</div>
                                <div class="modal-stat-label">Avg Response</div>
                            </div>
                            ` : ''}
                        </div>

                        ${d ? `
                        <div class="modal-section">
                            <div class="modal-section-title">âš™ï¸ Configuration</div>
                            <div class="modal-config">
                                <div class="config-row">
                                    <span class="config-label">ModÃ¨le</span>
                                    <span class="config-value">${d.model}</span>
                                </div>
                                <div class="config-row">
                                    <span class="config-label">Tokens aujourd'hui</span>
                                    <span class="config-value">${d.tokensToday}</span>
                                </div>
                                <div class="config-row">
                                    <span class="config-label">CoÃ»t</span>
                                    <span class="config-value">${d.costToday}</span>
                                </div>
                            </div>
                        </div>` : ''}

                        ${recentTasksHtml}
                    </div>
                </div>
            `;
            
            overlay.addEventListener('click', function(e) {
                if (e.target === overlay) {
                    closeModal(overlay.querySelector('.modal-close'));
                }
            });
            
            return overlay;
        }

        // Close modal function (global for onclick attributes)
        window.closeModal = function(closeButton) {
            const overlay = closeButton.closest('.modal-overlay');
            overlay.classList.remove('active');
            
            setTimeout(() => {
                overlay.remove();
            }, 300);
        };

        // Expose functions for external access
        window.orchestrationDashboard = {
            updateDashboard,
            updateStats,
            updateTasks,
            updateAgents,
            showTaskDetail,
            showAgentDetail
        };
    </script>
</body>
</html>