<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Sprite Direction Test</title>
<style>
body { background: #1a1a2e; color: #fff; font-family: monospace; margin: 20px; }
.row { display: flex; gap: 20px; margin: 20px 0; align-items: flex-end; }
.sprite-box { text-align: center; }
.sprite-box img { width: 128px; height: 128px; image-rendering: pixelated; background: rgba(255,255,255,0.05); }
.sprite-box .label { font-size: 14px; margin: 5px 0; }
.arrow { font-size: 24px; color: #0f0; }
h2 { color: #0f0; border-bottom: 1px solid #333; padding-bottom: 5px; }
canvas { border: 1px solid #333; margin: 20px 0; }
.correct { color: #0f0; }
.wrong { color: #f00; }
</style>
</head>
<body>
<h1>ðŸ§ª Sprite Direction Test</h1>
<p>Base path: lib/sprites/kenney-mini-chars-upright/</p>

<h2>Walk Sprites â€” character-male-a</h2>
<div class="row">
<div class="sprite-box">
  <div class="label">SE folder<br>(screen â†˜ lower-right)</div>
  <img id="se">
  <div class="label">Should show: FACE, leaning right</div>
</div>
<div class="sprite-box">
  <div class="label">SW folder<br>(screen â†™ lower-left)</div>
  <img id="sw">
  <div class="label">Should show: FACE, leaning left</div>
</div>
<div class="sprite-box">
  <div class="label">NW folder<br>(screen â†– upper-left)</div>
  <img id="nw">
  <div class="label">Should show: BACK, leaning left</div>
</div>
<div class="sprite-box">
  <div class="label">NE folder<br>(screen â†— upper-right)</div>
  <img id="ne">
  <div class="label">Should show: BACK, leaning right</div>
</div>
</div>

<h2>Walking Animation Test</h2>
<canvas id="cvs" width="800" height="400"></canvas>
<p>4 characters walking in 4 directions. Each should face their movement direction.</p>

<script>
const BASE = 'lib/sprites/kenney-mini-chars-upright/character-male-a/walk_character-male-a';
const DIRS = ['SE', 'SW', 'NW', 'NE'];
const FRAMES = 8;

// Load static previews
// Remap: SEâ†”SW, NEâ†”NW (confirmed by Kira)
document.getElementById('se').src = BASE + '/SW/frame_002.png';
document.getElementById('sw').src = BASE + '/SE/frame_002.png';
document.getElementById('nw').src = BASE + '/NE/frame_002.png';
document.getElementById('ne').src = BASE + '/NW/frame_002.png';

// Animation test
const cvs = document.getElementById('cvs');
const ctx = cvs.getContext('2d');

// dir = the sprite FOLDER to load (with remap applied)
const walkers = [
  { dir: 'SW', dx: 1, dy: 0.5, x: 50, y: 150, label: 'SE â†˜' },   // SE movement â†’ SW folder
  { dir: 'SE', dx: -1, dy: 0.5, x: 750, y: 150, label: 'SW â†™' },  // SW movement â†’ SE folder
  { dir: 'NE', dx: -1, dy: -0.5, x: 750, y: 350, label: 'NW â†–' }, // NW movement â†’ NE folder
  { dir: 'NW', dx: 1, dy: -0.5, x: 50, y: 350, label: 'NE â†—' },   // NE movement â†’ NW folder
];

// Load all walk frames
const imgs = {};
let loaded = 0;
const total = DIRS.length * FRAMES;
DIRS.forEach(dir => {
  imgs[dir] = [];
  for (let f = 0; f < FRAMES; f++) {
    const img = new Image();
    img.onload = () => { loaded++; if (loaded === total) animate(); };
    img.src = `${BASE}/${dir}/frame_${String(f).padStart(3,'0')}.png`;
    imgs[dir].push(img);
  }
});

let frame = 0;
let tick = 0;

function animate() {
  tick++;
  if (tick % 6 === 0) frame = (frame + 1) % FRAMES;

  ctx.fillStyle = '#1a1a2e';
  ctx.fillRect(0, 0, 800, 400);

  // Draw grid
  ctx.strokeStyle = 'rgba(255,255,255,0.1)';
  for (let x = 0; x < 800; x += 50) { ctx.beginPath(); ctx.moveTo(x, 0); ctx.lineTo(x, 400); ctx.stroke(); }
  for (let y = 0; y < 400; y += 50) { ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(800, y); ctx.stroke(); }

  walkers.forEach(w => {
    // Move
    w.x += w.dx * 0.8;
    w.y += w.dy * 0.8;
    // Wrap
    if (w.x > 850) w.x = -50;
    if (w.x < -50) w.x = 850;
    if (w.y > 450) w.y = -50;
    if (w.y < -50) w.y = 450;

    // Draw sprite
    const img = imgs[w.dir][frame];
    if (img && img.complete) {
      ctx.drawImage(img, w.x - 40, w.y - 60, 80, 80);
    }

    // Label
    ctx.fillStyle = '#0f0';
    ctx.font = '12px monospace';
    ctx.textAlign = 'center';
    ctx.fillText(w.label, w.x, w.y + 30);

    // Direction arrow
    ctx.strokeStyle = '#ff0';
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(w.x, w.y);
    ctx.lineTo(w.x + w.dx * 20, w.y + w.dy * 20);
    ctx.stroke();
  });

  requestAnimationFrame(animate);
}
</script>
</body>
</html>
