<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpawnKit v2 â€” The Sims Office</title>
    <style>
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           The Sims 1 (2000) â€” Warm, Cozy, Isometric Office
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');

        :root {
            --sims-bg: #f0e0c0;
            --sims-wall: #dcc8a0;
            --sims-floor: #c09860;
            --sims-panel: #1a3a4a;
            --sims-panel-light: #2a4858;
            --sims-panel-lighter: #3a5868;
            --sims-plumbob: #00ff00;
            --sims-text-light: #e0e0e0;
            --sims-text-dark: #2a2a2a;
            --sims-accent: #5a8898;
            --sims-gold: #d4aa44;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: var(--sims-bg);
            color: var(--sims-text-dark);
            font-family: 'VT323', 'Trebuchet MS', 'Lucida Sans', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* â”€â”€ Title Bar (like Sims 1 window chrome) â”€â”€â”€â”€â”€â”€ */
        .sims-title-bar {
            width: 100%;
            max-width: 920px;
            background: linear-gradient(180deg, var(--sims-panel-lighter) 0%, var(--sims-panel) 100%);
            color: var(--sims-text-light);
            text-align: center;
            padding: 8px 16px;
            font-size: 18px;
            letter-spacing: 2px;
            border-bottom: 2px solid var(--sims-accent);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .sims-title-bar .plumbob-icon {
            display: inline-block;
            width: 14px;
            height: 22px;
            position: relative;
        }
        .sims-title-bar .plumbob-icon::before,
        .sims-title-bar .plumbob-icon::after {
            content: '';
            position: absolute;
            left: 0;
            width: 0; height: 0;
            border-left: 7px solid transparent;
            border-right: 7px solid transparent;
        }
        .sims-title-bar .plumbob-icon::before {
            top: 0;
            border-bottom: 11px solid var(--sims-plumbob);
        }
        .sims-title-bar .plumbob-icon::after {
            bottom: 0;
            border-top: 11px solid #00cc00;
        }

        /* â”€â”€ Game Container â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        #gameContainer {
            position: relative;
            border-left: 3px solid var(--sims-panel);
            border-right: 3px solid var(--sims-panel);
            background: var(--sims-bg);
            max-width: 920px;
            overflow: hidden;
        }

        #gameContainer canvas {
            display: block;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }

        /* â”€â”€ Bottom Panel (THE iconic Sims UI) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        #simsPanel {
            width: 100%;
            max-width: 920px;
            background: linear-gradient(180deg, var(--sims-panel-light) 0%, var(--sims-panel) 100%);
            border-top: 3px solid var(--sims-accent);
            border-left: 3px solid var(--sims-panel);
            border-right: 3px solid var(--sims-panel);
            border-bottom: 3px solid #0a2a3a;
            padding: 8px 12px;
            color: var(--sims-text-light);
        }

        .sims-panel-inner {
            display: flex;
            align-items: stretch;
            gap: 12px;
            min-height: 90px;
        }

        /* â”€â”€ Portrait Section â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .sims-portrait-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 80px;
            gap: 2px;
        }

        .sims-portrait {
            width: 64px;
            height: 64px;
            border: 2px solid var(--sims-accent);
            border-radius: 4px;
            overflow: hidden;
            background: var(--sims-panel);
        }

        .sims-portrait canvas {
            width: 64px;
            height: 64px;
            image-rendering: pixelated;
        }

        .sims-agent-name {
            font-size: 13px;
            font-weight: bold;
            color: var(--sims-gold);
            text-align: center;
            white-space: nowrap;
        }

        .sims-agent-role {
            font-size: 11px;
            color: var(--sims-accent);
            text-align: center;
        }

        .sims-agent-nav {
            display: flex;
            gap: 4px;
            margin-top: 2px;
        }

        /* â”€â”€ Needs Section â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .sims-needs-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 3px;
            padding: 0 8px;
        }

        .sims-need-row {
            display: flex;
            align-items: center;
            gap: 4px;
            height: 14px;
        }

        .sims-need-icon {
            font-size: 11px;
            width: 16px;
            text-align: center;
        }

        .sims-need-label {
            font-size: 11px;
            color: #a0b8c8;
            min-width: 52px;
        }

        .sims-need-bar {
            flex: 1;
            height: 10px;
            background: #0a2030;
            border: 1px solid #3a5868;
            border-radius: 2px;
            overflow: hidden;
            position: relative;
        }

        .sims-need-fill {
            height: 100%;
            background: linear-gradient(90deg, #00aa00, #00cc00);
            transition: width 0.8s ease, background 0.8s ease;
            border-radius: 1px;
            box-shadow: inset 0 1px 0 rgba(255,255,255,0.2);
        }

        /* â”€â”€ Controls Section â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .sims-controls-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 6px;
            min-width: 100px;
        }

        .sims-speed-controls {
            display: flex;
            gap: 3px;
        }

        .sims-btn {
            background: var(--sims-panel-lighter);
            color: var(--sims-text-light);
            border: 1px solid var(--sims-accent);
            padding: 3px 8px;
            font-family: inherit;
            font-size: 11px;
            cursor: pointer;
            border-radius: 3px;
            transition: background 0.15s;
        }

        .sims-btn:hover {
            background: var(--sims-accent);
        }

        .sims-btn.active {
            background: var(--sims-accent);
            border-color: var(--sims-gold);
            box-shadow: 0 0 4px rgba(212, 170, 68, 0.4);
        }

        .sims-btn-sm {
            padding: 1px 6px;
            font-size: 10px;
        }

        .sims-speed-btn {
            font-size: 9px;
            padding: 2px 5px;
        }

        .sims-mode-buttons {
            display: flex;
            gap: 4px;
        }

        .sims-mode-btn {
            font-size: 16px;
            padding: 2px 8px;
        }

        .sims-simoleons {
            font-size: 14px;
            color: var(--sims-gold);
            font-weight: bold;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }

        /* â”€â”€ Mode Tooltip â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .sims-mode-tooltip {
            position: fixed;
            bottom: 120px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--sims-panel);
            color: var(--sims-text-light);
            padding: 8px 16px;
            border: 1px solid var(--sims-accent);
            border-radius: 6px;
            font-size: 13px;
            z-index: 9999;
            animation: tooltipFade 2s ease forwards;
            pointer-events: none;
        }

        @keyframes tooltipFade {
            0% { opacity: 1; transform: translateX(-50%) translateY(0); }
            70% { opacity: 1; }
            100% { opacity: 0; transform: translateX(-50%) translateY(-10px); }
        }

        /* â”€â”€ HUD Bar (below panel) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        #simsHUD {
            width: 100%;
            max-width: 920px;
            background: var(--sims-panel);
            padding: 6px 16px;
            font-size: 12px;
            color: var(--sims-accent);
            display: flex;
            justify-content: center;
            gap: 16px;
            border-bottom: 2px solid #0a2a3a;
        }

        .hud-item { white-space: nowrap; }
        .hud-sep { color: #2a4858; }

        /* â”€â”€ Responsive â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        @media (max-width: 700px) {
            .sims-panel-inner { flex-wrap: wrap; }
            .sims-portrait-section { flex-direction: row; gap: 8px; min-width: 100%; }
            .sims-needs-section { min-width: 100%; }
        }
    </style>
</head>
<body>

    <!-- Title bar -->
    <div class="sims-title-bar">
        <span class="plumbob-icon"></span>
        SPAWNKIT â€” THE SIMS OFFICE
        <span class="plumbob-icon"></span>
    </div>

    <!-- Game canvas -->
    <div id="gameContainer"></div>

    <!-- Bottom Sims UI panel -->
    <div id="simsPanel">
        <!-- Populated by sims-ui.js -->
    </div>

    <!-- HUD bar -->
    <div id="simsHUD">
        <span class="hud-item" id="hudAgents">ğŸ‘¥ 5 Agents</span>
        <span class="hud-sep">|</span>
        <span class="hud-item" id="hudMissions">ğŸ“‹ 0 Missions</span>
        <span class="hud-sep">|</span>
        <span class="hud-item" id="hudScore">ğŸ† 0 pts</span>
        <span class="hud-sep">|</span>
        <span class="hud-item" id="hudTime">ğŸ• --:--</span>
    </div>

    <!-- â•â•â• SHARED SCRIPTS (same as GameBoy theme) â•â•â• -->

    <!-- PixiJS v7 -->
    <script src="../lib/pixi.min.js"></script>

    <!-- Visual Polish -->
    <script src="../src/favicon.js"></script>
    <script src="../src/meta-tags.js"></script>
    <script src="../src/page-title.js"></script>

    <!-- Theme Names (universe-consistent naming) -->
    <script src="../src/theme-names.js"></script>

    <!-- Data Bridge -->
    <script src="../src/data-bridge.js"></script>

    <!-- Sprites -->
    <script src="../src/sprites.js"></script>

    <!-- Mission Controller -->
    <script src="../src/mission-controller.js"></script>

    <!-- Boot Sequence -->
    <script src="../src/boot-sequence.js"></script>

    <!-- Theme Switcher -->
    <script src="../src/theme-switcher.js"></script>

    <!-- Responsive & Transitions -->
    <script src="../src/responsive.js"></script>
    <script src="../src/transitions.js"></script>

    <!-- UX Layer -->
    <script src="../src/ux-layer.js"></script>
    <script src="../src/achievements.js"></script>

    <!-- OpenClaw Integration -->
    <script src="../src/openclaw-helpers.js"></script>

    <!-- Click Affordances -->
    <script src="../src/click-affordances.js"></script>

    <!-- â•â•â• SIMS THEME SCRIPTS â•â•â• -->

    <!-- Effects (loaded before office so SimsEffects class is available) -->
    <script src="sims-effects.js"></script>

    <!-- UI panel -->
    <script src="sims-ui.js"></script>

    <!-- Characters (with Plumbob) -->
    <script src="sims-characters.js"></script>

    <!-- State bridge (SpawnKit â†” Sims) -->
    <script src="sims-state-bridge.js"></script>

    <!-- Main office engine (initializes everything) -->
    <script src="sims-office.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            // Initialize UX Layer
            if (typeof SpawnKitUX !== 'undefined') {
                SpawnKitUX.init({ theme: 'sims' });
            }
            // Initialize OpenClaw Helpers
            if (typeof OpenClawHelpers !== 'undefined') {
                OpenClawHelpers.init({ theme: 'sims' });
            }

            // Optional boot sequence
            const params = new URLSearchParams(window.location.search);
            const shouldBoot = params.has('boot') || !localStorage.getItem('spawnkit-booted-sims');

            if (shouldBoot && typeof SpawnKitBoot !== 'undefined') {
                const overlay = document.createElement('div');
                overlay.id = 'bootOverlay';
                overlay.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;z-index:9999;background:#1a3a4a;display:flex;align-items:center;justify-content:center;color:#e0e0e0;font-family:VT323,monospace;font-size:24px;flex-direction:column;gap:16px;';
                overlay.innerHTML = `
                    <div style="font-size:40px;">ğŸ’</div>
                    <div>Loading The Sims Office...</div>
                    <div style="font-size:14px;color:#5a8898;">Sul sul!</div>
                `;
                document.body.prepend(overlay);

                try {
                    await SpawnKitBoot.play('sims', overlay, {
                        soundEnabled: false,
                        skipable: true
                    });
                } catch(e) { console.warn('Boot skipped:', e); }

                localStorage.setItem('spawnkit-booted-sims', 'true');
                overlay.style.transition = 'opacity 0.5s';
                overlay.style.opacity = '0';
                setTimeout(() => overlay.remove(), 500);
            }

            // Theme switcher â€” MANDATORY
            initThemeSwitcher();

            // Signal UX ready
            if (typeof SpawnKitUX !== 'undefined') {
                SpawnKitUX.ready();
            }

            // HUD updates
            function updateHUD() {
                try {
                    const data = typeof SpawnKit !== 'undefined' ? SpawnKit.data : null;
                    const ach = typeof SpawnKitAchievements !== 'undefined' ? SpawnKitAchievements : null;

                    if (data) {
                        const active = (data.missions || []).filter(m => m.status === 'active' || m.status === 'in_progress').length;
                        const agents = (data.agents || []).length;
                        const activeAgents = (data.agents || []).filter(a => a.status === 'active').length;
                        
                        document.getElementById('hudAgents').textContent = `ğŸ‘¥ ${activeAgents}/${agents} Active`;
                        document.getElementById('hudMissions').textContent = 'ğŸ“‹ ' + active + ' Mission' + (active !== 1 ? 's' : '');
                        
                        // Show total tokens/api calls in score
                        const tokens = data.metrics?.tokensToday || 0;
                        const apiCalls = data.metrics?.apiCallsToday || 0;
                        document.getElementById('hudScore').textContent = `ğŸ’° ${tokens.toLocaleString()} tokens`;
                    }

                    // Clock with work day indicator
                    const now = new Date();
                    const h = now.getHours().toString().padStart(2, '0');
                    const m = now.getMinutes().toString().padStart(2, '0');
                    const hour = now.getHours();
                    const dayIndicator = (hour >= 9 && hour < 17) ? 'â˜€ï¸' : (hour >= 17 && hour < 22) ? 'ğŸŒ†' : 'ğŸŒ™';
                    document.getElementById('hudTime').textContent = dayIndicator + ' ' + h + ':' + m;
                } catch(e) {}
            }

            updateHUD();
            setInterval(updateHUD, 5000);
        });
    </script>
</body>
</html>
